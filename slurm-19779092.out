[-] Unloading python 3.7  ... 
[+] Loading python 3.7  ... 
[-] Unloading snakemake  5.24.1 
[+] Loading snakemake  5.24.1 
[+] Loading singularity  3.8.0  on cn2291 
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cluster nodes: 500
Job counts:
	count	jobs
	1	all
	16	call_mutations
	1	create_nfragments_table
	16	create_toSNPcalling_BAM
	16	cutadapt
	16	fastq_screen
	1	get_fastq_nreads
	16	get_fastuniq_readids
	16	get_nfragments_json
	32	get_split_reads
	1	gtf2bed12
	16	hisat
	16	htseq
	16	split_bam_by_mutation
	16	star
	196

[Thu Jul 22 22:23:06 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_4SU_labeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_4SU_labeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R2.trim.fastq.gz
    jobid: 7
    wildcards: sample=WT4_4SU_labeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_4SU_labeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_4SU_labeled.R2.fastq.gz

Submitted job 7 with external jobid '19779332'.

[Thu Jul 22 22:23:09 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_labeled_1.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_labeled_1.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R2.trim.fastq.gz
    jobid: 9
    wildcards: sample=SRA_labeled_1
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_labeled_1.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_labeled_1.R2.fastq.gz

Submitted job 9 with external jobid '19779334'.

[Thu Jul 22 22:23:11 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_labeled_2.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_labeled_2.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R2.trim.fastq.gz
    jobid: 10
    wildcards: sample=SRA_labeled_2
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_labeled_2.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_labeled_2.R2.fastq.gz

Submitted job 10 with external jobid '19779336'.

[Thu Jul 22 22:23:19 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_unlabeled_2.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_unlabeled_2.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R2.trim.fastq.gz
    jobid: 12
    wildcards: sample=SRA_unlabeled_2
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_unlabeled_2.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_unlabeled_2.R2.fastq.gz

Submitted job 12 with external jobid '19779339'.

[Thu Jul 22 22:23:22 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_techrep2_unlabeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_techrep2_unlabeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R2.trim.fastq.gz
    jobid: 14
    wildcards: sample=KO1_techrep2_unlabeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_techrep2_unlabeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_techrep2_unlabeled.R2.fastq.gz

Submitted job 14 with external jobid '19779342'.

[Thu Jul 22 22:23:27 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_4SU_labeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_4SU_labeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R2.trim.fastq.gz
    jobid: 1
    wildcards: sample=KO1_4SU_labeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_4SU_labeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_4SU_labeled.R2.fastq.gz

Submitted job 1 with external jobid '19779344'.

[Thu Jul 22 22:23:31 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_techrep2_unlabeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_techrep2_unlabeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R2.trim.fastq.gz
    jobid: 16
    wildcards: sample=WT4_techrep2_unlabeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_techrep2_unlabeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_techrep2_unlabeled.R2.fastq.gz

Submitted job 16 with external jobid '19779452'.

[Thu Jul 22 22:23:38 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO8_unlabeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO8_unlabeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R2.trim.fastq.gz
    jobid: 4
    wildcards: sample=KO8_unlabeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO8_unlabeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO8_unlabeled.R2.fastq.gz

Submitted job 4 with external jobid '19779542'.

[Thu Jul 22 22:23:49 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_techrep1_unlabeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_techrep1_unlabeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R2.trim.fastq.gz
    jobid: 15
    wildcards: sample=WT4_techrep1_unlabeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_techrep1_unlabeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_techrep1_unlabeled.R2.fastq.gz

Submitted job 15 with external jobid '19779544'.

[Thu Jul 22 22:23:52 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT3_unlabeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT3_unlabeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R2.trim.fastq.gz
    jobid: 6
    wildcards: sample=WT3_unlabeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT3_unlabeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT3_unlabeled.R2.fastq.gz

Submitted job 6 with external jobid '19779545'.

[Thu Jul 22 22:23:57 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_unlabeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_unlabeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R2.trim.fastq.gz
    jobid: 8
    wildcards: sample=WT4_unlabeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_unlabeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT4_unlabeled.R2.fastq.gz

Submitted job 8 with external jobid '19779547'.

[Thu Jul 22 22:24:01 2021]
rule gtf2bed12:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/mm10.bed12
    jobid: 195


bn=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf)
gtfToGenePred /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf /dev/shm/${bn%.*}.genepred
genePredToBed /dev/shm/${bn%.*}.genepred /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/mm10.bed12

Submitted job 195 with external jobid '19779549'.

[Thu Jul 22 22:24:03 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_unlabeled_1.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_unlabeled_1.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R2.trim.fastq.gz
    jobid: 11
    wildcards: sample=SRA_unlabeled_1
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_unlabeled_1.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/SRA_unlabeled_1.R2.fastq.gz

Submitted job 11 with external jobid '19779550'.

[Thu Jul 22 22:24:06 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_techrep1_unlabeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_techrep1_unlabeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R2.trim.fastq.gz
    jobid: 13
    wildcards: sample=KO1_techrep1_unlabeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_techrep1_unlabeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_techrep1_unlabeled.R2.fastq.gz

Submitted job 13 with external jobid '19779552'.

[Thu Jul 22 22:24:08 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_unlabeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_unlabeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R2.trim.fastq.gz
    jobid: 2
    wildcards: sample=KO1_unlabeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_unlabeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO1_unlabeled.R2.fastq.gz

Submitted job 2 with external jobid '19779554'.

[Thu Jul 22 22:24:12 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO8_4SU_labeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO8_4SU_labeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R2.trim.fastq.gz
    jobid: 3
    wildcards: sample=KO8_4SU_labeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO8_4SU_labeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/KO8_4SU_labeled.R2.fastq.gz

Submitted job 3 with external jobid '19779561'.

[Thu Jul 22 22:24:19 2021]
rule cutadapt:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT3_4SU_labeled.R1.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT3_4SU_labeled.R2.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R2.trim.fastq.gz
    jobid: 5
    wildcards: sample=WT3_4SU_labeled
    threads: 56


cutadapt --pair-filter=any --nextseq-trim=2 --trim-n -n 5 -O 5 -q 10,10 -m 35:35 -b file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -B file:/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/TruSeq_and_nextera_adapters.consolidated.fa -j 56 -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R1.trim.fastq.gz -p /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R2.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT3_4SU_labeled.R1.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/fastqs/WT3_4SU_labeled.R2.fastq.gz

Submitted job 5 with external jobid '19779563'.
[Thu Jul 22 22:27:14 2021]
Finished job 195.
1 of 196 steps (0.51%) done
[Thu Jul 22 22:35:17 2021]
Finished job 12.
2 of 196 steps (1%) done

[Thu Jul 22 22:35:17 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.minus.bam.flagstat
    jobid: 158
    wildcards: sample=SRA_unlabeled_2
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix SRA_unlabeled_2. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_SRA_unlabeled_2 	--sjdbOverhang ${readlength}
rm -rf SRA_unlabeled_2._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.Aligned.out.bam > ${tmpdir}/SRA_unlabeled_2.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/SRA_unlabeled_2.post_secondary_supplementary_filter.bam ${tmpdir}/SRA_unlabeled_2.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/SRA_unlabeled_2.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/SRA_unlabeled_2.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/SRA_unlabeled_2.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/SRA_unlabeled_2.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/SRA_unlabeled_2.post_secondary_supplementary_filter.bam -o ${tmpdir}/SRA_unlabeled_2.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/SRA_unlabeled_2.post_insertion_filter.bam  O=${tmpdir}/SRA_unlabeled_2.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/SRA_unlabeled_2.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/SRA_unlabeled_2.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.bam > ${tmpdir}/SRA_unlabeled_2

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.bam > ${tmpdir}/SRA_unlabeled_2.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.bam > ${tmpdir}/SRA_unlabeled_2.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/SRA_unlabeled_2.F.bam ${tmpdir}/SRA_unlabeled_2.F1.bam ${tmpdir}/SRA_unlabeled_2.F2.bam
#rm -f ${tmpdir}/SRA_unlabeled_2.F1.bam ${tmpdir}/SRA_unlabeled_2.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.bam > ${tmpdir}/SRA_unlabeled_2.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.bam > ${tmpdir}/SRA_unlabeled_2.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/SRA_unlabeled_2.R.bam ${tmpdir}/SRA_unlabeled_2.R1.bam ${tmpdir}/SRA_unlabeled_2.R2.bam
#rm -f ${tmpdir}/SRA_unlabeled_2.R1.bam ${tmpdir}/SRA_unlabeled_2.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.plus.bam ${tmpdir}/SRA_unlabeled_2.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.minus.bam ${tmpdir}/SRA_unlabeled_2.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_2.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/SRA_unlabeled_2.*
rm -rf _STARtmp


Submitted job 158 with external jobid '19780419'.

[Thu Jul 22 22:35:22 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam.flagstat
    jobid: 61
    wildcards: sample=SRA_unlabeled_2
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.hisat2.summary.log  --threads 56  --rg-id SRA_unlabeled_2 --rg SM:SRA_unlabeled_2  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/SRA_unlabeled_2.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_unlabeled_2.post_secondary_supplementary_filter.bam /dev/shm/SRA_unlabeled_2.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/SRA_unlabeled_2.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/SRA_unlabeled_2.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/SRA_unlabeled_2.post_secondary_supplementary_filter.bam -o /dev/shm/SRA_unlabeled_2.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_unlabeled_2.post_insertion_filter.bam /dev/shm/SRA_unlabeled_2.post_insertion_filter.tmp.bam && rm -f /dev/shm/SRA_unlabeled_2.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/SRA_unlabeled_2.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_unlabeled_2.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/SRA_unlabeled_2.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/SRA_unlabeled_2.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.bam > /dev/shm/SRA_unlabeled_2.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.bam > /dev/shm/SRA_unlabeled_2.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/SRA_unlabeled_2.F.bam /dev/shm/SRA_unlabeled_2.F1.bam /dev/shm/SRA_unlabeled_2.F2.bam && rm -f /dev/shm/SRA_unlabeled_2.F1.bam /dev/shm/SRA_unlabeled_2.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.bam > /dev/shm/SRA_unlabeled_2.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.bam > /dev/shm/SRA_unlabeled_2.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/SRA_unlabeled_2.R.bam /dev/shm/SRA_unlabeled_2.R1.bam /dev/shm/SRA_unlabeled_2.R2.bam && rm -f /dev/shm/SRA_unlabeled_2.R1.bam /dev/shm/SRA_unlabeled_2.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam /dev/shm/SRA_unlabeled_2.F.bam && rm -f /dev/shm/SRA_unlabeled_2.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam /dev/shm/SRA_unlabeled_2.R.bam && rm -f /dev/shm/SRA_unlabeled_2.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/SRA_unlabeled_2.*


Submitted job 61 with external jobid '19780503'.

[Thu Jul 22 22:35:25 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_2.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_2.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_2.fastuniq.readids
    jobid: 28
    wildcards: sample=SRA_unlabeled_2
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.R2.fastq
echo "/lscratch/${SLURM_JOBID}/SRA_unlabeled_2.R1.fastq" > /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.list
echo "/lscratch/${SLURM_JOBID}/SRA_unlabeled_2.R2.fastq" >> /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.list -t q -o /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_2.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_2.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/SRA_unlabeled_2.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_2.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 28 with external jobid '19780556'.

[Thu Jul 22 22:35:31 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/SRA_unlabeled_2.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/SRA_unlabeled_2.R2.trim_screen.txt
    jobid: 45
    wildcards: sample=SRA_unlabeled_2
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_2.R2.trim.fastq.gz

Submitted job 45 with external jobid '19780558'.
[Thu Jul 22 22:37:29 2021]
Finished job 11.
3 of 196 steps (2%) done

[Thu Jul 22 22:37:29 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam.flagstat
    jobid: 60
    wildcards: sample=SRA_unlabeled_1
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.hisat2.summary.log  --threads 56  --rg-id SRA_unlabeled_1 --rg SM:SRA_unlabeled_1  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/SRA_unlabeled_1.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_unlabeled_1.post_secondary_supplementary_filter.bam /dev/shm/SRA_unlabeled_1.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/SRA_unlabeled_1.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/SRA_unlabeled_1.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/SRA_unlabeled_1.post_secondary_supplementary_filter.bam -o /dev/shm/SRA_unlabeled_1.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_unlabeled_1.post_insertion_filter.bam /dev/shm/SRA_unlabeled_1.post_insertion_filter.tmp.bam && rm -f /dev/shm/SRA_unlabeled_1.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/SRA_unlabeled_1.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_unlabeled_1.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/SRA_unlabeled_1.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/SRA_unlabeled_1.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.bam > /dev/shm/SRA_unlabeled_1.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.bam > /dev/shm/SRA_unlabeled_1.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/SRA_unlabeled_1.F.bam /dev/shm/SRA_unlabeled_1.F1.bam /dev/shm/SRA_unlabeled_1.F2.bam && rm -f /dev/shm/SRA_unlabeled_1.F1.bam /dev/shm/SRA_unlabeled_1.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.bam > /dev/shm/SRA_unlabeled_1.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.bam > /dev/shm/SRA_unlabeled_1.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/SRA_unlabeled_1.R.bam /dev/shm/SRA_unlabeled_1.R1.bam /dev/shm/SRA_unlabeled_1.R2.bam && rm -f /dev/shm/SRA_unlabeled_1.R1.bam /dev/shm/SRA_unlabeled_1.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam /dev/shm/SRA_unlabeled_1.F.bam && rm -f /dev/shm/SRA_unlabeled_1.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam /dev/shm/SRA_unlabeled_1.R.bam && rm -f /dev/shm/SRA_unlabeled_1.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/SRA_unlabeled_1.*


Submitted job 60 with external jobid '19780630'.

[Thu Jul 22 22:37:31 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_1.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_1.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_1.fastuniq.readids
    jobid: 27
    wildcards: sample=SRA_unlabeled_1
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.R2.fastq
echo "/lscratch/${SLURM_JOBID}/SRA_unlabeled_1.R1.fastq" > /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.list
echo "/lscratch/${SLURM_JOBID}/SRA_unlabeled_1.R2.fastq" >> /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.list -t q -o /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_1.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_1.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/SRA_unlabeled_1.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_1.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 27 with external jobid '19780633'.

[Thu Jul 22 22:37:33 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.minus.bam.flagstat
    jobid: 157
    wildcards: sample=SRA_unlabeled_1
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix SRA_unlabeled_1. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_SRA_unlabeled_1 	--sjdbOverhang ${readlength}
rm -rf SRA_unlabeled_1._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.Aligned.out.bam > ${tmpdir}/SRA_unlabeled_1.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/SRA_unlabeled_1.post_secondary_supplementary_filter.bam ${tmpdir}/SRA_unlabeled_1.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/SRA_unlabeled_1.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/SRA_unlabeled_1.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/SRA_unlabeled_1.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/SRA_unlabeled_1.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/SRA_unlabeled_1.post_secondary_supplementary_filter.bam -o ${tmpdir}/SRA_unlabeled_1.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/SRA_unlabeled_1.post_insertion_filter.bam  O=${tmpdir}/SRA_unlabeled_1.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/SRA_unlabeled_1.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/SRA_unlabeled_1.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.bam > ${tmpdir}/SRA_unlabeled_1

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.bam > ${tmpdir}/SRA_unlabeled_1.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.bam > ${tmpdir}/SRA_unlabeled_1.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/SRA_unlabeled_1.F.bam ${tmpdir}/SRA_unlabeled_1.F1.bam ${tmpdir}/SRA_unlabeled_1.F2.bam
#rm -f ${tmpdir}/SRA_unlabeled_1.F1.bam ${tmpdir}/SRA_unlabeled_1.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.bam > ${tmpdir}/SRA_unlabeled_1.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.bam > ${tmpdir}/SRA_unlabeled_1.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/SRA_unlabeled_1.R.bam ${tmpdir}/SRA_unlabeled_1.R1.bam ${tmpdir}/SRA_unlabeled_1.R2.bam
#rm -f ${tmpdir}/SRA_unlabeled_1.R1.bam ${tmpdir}/SRA_unlabeled_1.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.plus.bam ${tmpdir}/SRA_unlabeled_1.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.minus.bam ${tmpdir}/SRA_unlabeled_1.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_unlabeled_1.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/SRA_unlabeled_1.*
rm -rf _STARtmp


Submitted job 157 with external jobid '19780636'.

[Thu Jul 22 22:37:34 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/SRA_unlabeled_1.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/SRA_unlabeled_1.R2.trim_screen.txt
    jobid: 44
    wildcards: sample=SRA_unlabeled_1
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_unlabeled_1.R2.trim.fastq.gz

Submitted job 44 with external jobid '19780638'.
[Thu Jul 22 22:37:52 2021]
Finished job 9.
4 of 196 steps (2%) done

[Thu Jul 22 22:37:52 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_1.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_1.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_1.fastuniq.readids
    jobid: 25
    wildcards: sample=SRA_labeled_1
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/SRA_labeled_1.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/SRA_labeled_1.R2.fastq
echo "/lscratch/${SLURM_JOBID}/SRA_labeled_1.R1.fastq" > /lscratch/${SLURM_JOBID}/SRA_labeled_1.list
echo "/lscratch/${SLURM_JOBID}/SRA_labeled_1.R2.fastq" >> /lscratch/${SLURM_JOBID}/SRA_labeled_1.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/SRA_labeled_1.list -t q -o /lscratch/${SLURM_JOBID}/SRA_labeled_1.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/SRA_labeled_1.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/SRA_labeled_1.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_1.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/SRA_labeled_1.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/SRA_labeled_1.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_1.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/SRA_labeled_1.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/SRA_labeled_1.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_1.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 25 with external jobid '19780656'.

[Thu Jul 22 22:37:54 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/SRA_labeled_1.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/SRA_labeled_1.R2.trim_screen.txt
    jobid: 42
    wildcards: sample=SRA_labeled_1
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R2.trim.fastq.gz

Submitted job 42 with external jobid '19780658'.

[Thu Jul 22 22:37:55 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.minus.bam.flagstat
    jobid: 155
    wildcards: sample=SRA_labeled_1
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix SRA_labeled_1. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_SRA_labeled_1 	--sjdbOverhang ${readlength}
rm -rf SRA_labeled_1._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.Aligned.out.bam > ${tmpdir}/SRA_labeled_1.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/SRA_labeled_1.post_secondary_supplementary_filter.bam ${tmpdir}/SRA_labeled_1.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/SRA_labeled_1.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/SRA_labeled_1.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/SRA_labeled_1.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/SRA_labeled_1.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/SRA_labeled_1.post_secondary_supplementary_filter.bam -o ${tmpdir}/SRA_labeled_1.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/SRA_labeled_1.post_insertion_filter.bam  O=${tmpdir}/SRA_labeled_1.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/SRA_labeled_1.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/SRA_labeled_1.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.bam > ${tmpdir}/SRA_labeled_1

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.bam > ${tmpdir}/SRA_labeled_1.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.bam > ${tmpdir}/SRA_labeled_1.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/SRA_labeled_1.F.bam ${tmpdir}/SRA_labeled_1.F1.bam ${tmpdir}/SRA_labeled_1.F2.bam
#rm -f ${tmpdir}/SRA_labeled_1.F1.bam ${tmpdir}/SRA_labeled_1.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.bam > ${tmpdir}/SRA_labeled_1.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.bam > ${tmpdir}/SRA_labeled_1.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/SRA_labeled_1.R.bam ${tmpdir}/SRA_labeled_1.R1.bam ${tmpdir}/SRA_labeled_1.R2.bam
#rm -f ${tmpdir}/SRA_labeled_1.R1.bam ${tmpdir}/SRA_labeled_1.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.plus.bam ${tmpdir}/SRA_labeled_1.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.minus.bam ${tmpdir}/SRA_labeled_1.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_1.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/SRA_labeled_1.*
rm -rf _STARtmp


Submitted job 155 with external jobid '19780660'.

[Thu Jul 22 22:37:56 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam.flagstat
    jobid: 58
    wildcards: sample=SRA_labeled_1
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_1.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.hisat2.summary.log  --threads 56  --rg-id SRA_labeled_1 --rg SM:SRA_labeled_1  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/SRA_labeled_1.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_labeled_1.post_secondary_supplementary_filter.bam /dev/shm/SRA_labeled_1.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/SRA_labeled_1.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/SRA_labeled_1.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/SRA_labeled_1.post_secondary_supplementary_filter.bam -o /dev/shm/SRA_labeled_1.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_labeled_1.post_insertion_filter.bam /dev/shm/SRA_labeled_1.post_insertion_filter.tmp.bam && rm -f /dev/shm/SRA_labeled_1.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/SRA_labeled_1.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_labeled_1.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/SRA_labeled_1.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/SRA_labeled_1.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.bam > /dev/shm/SRA_labeled_1.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.bam > /dev/shm/SRA_labeled_1.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/SRA_labeled_1.F.bam /dev/shm/SRA_labeled_1.F1.bam /dev/shm/SRA_labeled_1.F2.bam && rm -f /dev/shm/SRA_labeled_1.F1.bam /dev/shm/SRA_labeled_1.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.bam > /dev/shm/SRA_labeled_1.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.bam > /dev/shm/SRA_labeled_1.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/SRA_labeled_1.R.bam /dev/shm/SRA_labeled_1.R1.bam /dev/shm/SRA_labeled_1.R2.bam && rm -f /dev/shm/SRA_labeled_1.R1.bam /dev/shm/SRA_labeled_1.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam /dev/shm/SRA_labeled_1.F.bam && rm -f /dev/shm/SRA_labeled_1.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam /dev/shm/SRA_labeled_1.R.bam && rm -f /dev/shm/SRA_labeled_1.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/SRA_labeled_1.*


Submitted job 58 with external jobid '19780662'.
[Thu Jul 22 22:40:53 2021]
Finished job 10.
5 of 196 steps (3%) done

[Thu Jul 22 22:40:53 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_2.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_2.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_2.fastuniq.readids
    jobid: 26
    wildcards: sample=SRA_labeled_2
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/SRA_labeled_2.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/SRA_labeled_2.R2.fastq
echo "/lscratch/${SLURM_JOBID}/SRA_labeled_2.R1.fastq" > /lscratch/${SLURM_JOBID}/SRA_labeled_2.list
echo "/lscratch/${SLURM_JOBID}/SRA_labeled_2.R2.fastq" >> /lscratch/${SLURM_JOBID}/SRA_labeled_2.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/SRA_labeled_2.list -t q -o /lscratch/${SLURM_JOBID}/SRA_labeled_2.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/SRA_labeled_2.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/SRA_labeled_2.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_2.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/SRA_labeled_2.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/SRA_labeled_2.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_2.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/SRA_labeled_2.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/SRA_labeled_2.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_2.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 26 with external jobid '19780951'.

[Thu Jul 22 22:40:54 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/SRA_labeled_2.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/SRA_labeled_2.R2.trim_screen.txt
    jobid: 43
    wildcards: sample=SRA_labeled_2
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R2.trim.fastq.gz

Submitted job 43 with external jobid '19780953'.

[Thu Jul 22 22:40:56 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam.flagstat
    jobid: 59
    wildcards: sample=SRA_labeled_2
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.hisat2.summary.log  --threads 56  --rg-id SRA_labeled_2 --rg SM:SRA_labeled_2  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/SRA_labeled_2.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_labeled_2.post_secondary_supplementary_filter.bam /dev/shm/SRA_labeled_2.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/SRA_labeled_2.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/SRA_labeled_2.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/SRA_labeled_2.post_secondary_supplementary_filter.bam -o /dev/shm/SRA_labeled_2.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_labeled_2.post_insertion_filter.bam /dev/shm/SRA_labeled_2.post_insertion_filter.tmp.bam && rm -f /dev/shm/SRA_labeled_2.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/SRA_labeled_2.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/SRA_labeled_2.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/SRA_labeled_2.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/SRA_labeled_2.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.bam > /dev/shm/SRA_labeled_2.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.bam > /dev/shm/SRA_labeled_2.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/SRA_labeled_2.F.bam /dev/shm/SRA_labeled_2.F1.bam /dev/shm/SRA_labeled_2.F2.bam && rm -f /dev/shm/SRA_labeled_2.F1.bam /dev/shm/SRA_labeled_2.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.bam > /dev/shm/SRA_labeled_2.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.bam > /dev/shm/SRA_labeled_2.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/SRA_labeled_2.R.bam /dev/shm/SRA_labeled_2.R1.bam /dev/shm/SRA_labeled_2.R2.bam && rm -f /dev/shm/SRA_labeled_2.R1.bam /dev/shm/SRA_labeled_2.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam /dev/shm/SRA_labeled_2.F.bam && rm -f /dev/shm/SRA_labeled_2.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam /dev/shm/SRA_labeled_2.R.bam && rm -f /dev/shm/SRA_labeled_2.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/SRA_labeled_2.*


Submitted job 59 with external jobid '19780955'.

[Thu Jul 22 22:40:57 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.minus.bam.flagstat
    jobid: 156
    wildcards: sample=SRA_labeled_2
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/SRA_labeled_2.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix SRA_labeled_2. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_SRA_labeled_2 	--sjdbOverhang ${readlength}
rm -rf SRA_labeled_2._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.Aligned.out.bam > ${tmpdir}/SRA_labeled_2.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/SRA_labeled_2.post_secondary_supplementary_filter.bam ${tmpdir}/SRA_labeled_2.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/SRA_labeled_2.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/SRA_labeled_2.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/SRA_labeled_2.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/SRA_labeled_2.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/SRA_labeled_2.post_secondary_supplementary_filter.bam -o ${tmpdir}/SRA_labeled_2.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/SRA_labeled_2.post_insertion_filter.bam  O=${tmpdir}/SRA_labeled_2.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/SRA_labeled_2.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/SRA_labeled_2.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.bam > ${tmpdir}/SRA_labeled_2

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.bam > ${tmpdir}/SRA_labeled_2.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.bam > ${tmpdir}/SRA_labeled_2.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/SRA_labeled_2.F.bam ${tmpdir}/SRA_labeled_2.F1.bam ${tmpdir}/SRA_labeled_2.F2.bam
#rm -f ${tmpdir}/SRA_labeled_2.F1.bam ${tmpdir}/SRA_labeled_2.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.bam > ${tmpdir}/SRA_labeled_2.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.bam > ${tmpdir}/SRA_labeled_2.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/SRA_labeled_2.R.bam ${tmpdir}/SRA_labeled_2.R1.bam ${tmpdir}/SRA_labeled_2.R2.bam
#rm -f ${tmpdir}/SRA_labeled_2.R1.bam ${tmpdir}/SRA_labeled_2.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.plus.bam ${tmpdir}/SRA_labeled_2.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.minus.bam ${tmpdir}/SRA_labeled_2.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/SRA_labeled_2.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/SRA_labeled_2.*
rm -rf _STARtmp


Submitted job 156 with external jobid '19780957'.
[Thu Jul 22 22:42:30 2021]
Finished job 28.
6 of 196 steps (3%) done
[Thu Jul 22 22:43:06 2021]
Finished job 45.
7 of 196 steps (4%) done
[Thu Jul 22 22:43:18 2021]
Finished job 44.
8 of 196 steps (4%) done
[Thu Jul 22 22:44:30 2021]
Finished job 27.
9 of 196 steps (5%) done
[Thu Jul 22 22:47:54 2021]
Finished job 42.
10 of 196 steps (5%) done
[Thu Jul 22 22:48:17 2021]
Finished job 26.
11 of 196 steps (6%) done
[Thu Jul 22 22:48:29 2021]
Finished job 25.
12 of 196 steps (6%) done
[Thu Jul 22 22:53:07 2021]
Finished job 43.
13 of 196 steps (7%) done
[Thu Jul 22 22:58:31 2021]
Finished job 61.
14 of 196 steps (7%) done

[Thu Jul 22 22:58:31 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_2.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.toSNPcalling.bam.flagstat
    jobid: 174
    wildcards: sample=SRA_unlabeled_2
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam -o /dev/shm/SRA_unlabeled_2.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_2.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.toSNPcalling.bam /dev/shm/SRA_unlabeled_2.plus.bam && rm -f /dev/shm/SRA_unlabeled_2.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam -o /dev/shm/SRA_unlabeled_2.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_2.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.toSNPcalling.bam /dev/shm/SRA_unlabeled_2.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.toSNPcalling.bam.flagstat

Submitted job 174 with external jobid '19782314'.
[Thu Jul 22 23:00:55 2021]
Finished job 58.
15 of 196 steps (8%) done

[Thu Jul 22 23:00:55 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_1.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.toSNPcalling.bam.flagstat
    jobid: 171
    wildcards: sample=SRA_labeled_1
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam -o /dev/shm/SRA_labeled_1.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_1.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.toSNPcalling.bam /dev/shm/SRA_labeled_1.plus.bam && rm -f /dev/shm/SRA_labeled_1.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam -o /dev/shm/SRA_labeled_1.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_1.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.toSNPcalling.bam /dev/shm/SRA_labeled_1.minus.bam && rm -f /dev/shm/SRA_labeled_1.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.toSNPcalling.bam.flagstat

Submitted job 171 with external jobid '19782484'.
[Thu Jul 22 23:03:07 2021]
Finished job 60.
16 of 196 steps (8%) done

[Thu Jul 22 23:03:07 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_1.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.toSNPcalling.bam.flagstat
    jobid: 173
    wildcards: sample=SRA_unlabeled_1
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam -o /dev/shm/SRA_unlabeled_1.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_1.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.toSNPcalling.bam /dev/shm/SRA_unlabeled_1.plus.bam && rm -f /dev/shm/SRA_unlabeled_1.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam -o /dev/shm/SRA_unlabeled_1.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_1.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.toSNPcalling.bam /dev/shm/SRA_unlabeled_1.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.toSNPcalling.bam.flagstat

Submitted job 173 with external jobid '19782640'.
[Thu Jul 22 23:05:06 2021]
Finished job 8.
17 of 196 steps (9%) done

[Thu Jul 22 23:05:06 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_unlabeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_unlabeled.fastuniq.readids
    jobid: 24
    wildcards: sample=WT4_unlabeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT4_unlabeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT4_unlabeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/WT4_unlabeled.R1.fastq" > /lscratch/${SLURM_JOBID}/WT4_unlabeled.list
echo "/lscratch/${SLURM_JOBID}/WT4_unlabeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/WT4_unlabeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/WT4_unlabeled.list -t q -o /lscratch/${SLURM_JOBID}/WT4_unlabeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/WT4_unlabeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/WT4_unlabeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_unlabeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/WT4_unlabeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT4_unlabeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_unlabeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/WT4_unlabeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT4_unlabeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_unlabeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 24 with external jobid '19782947'.

[Thu Jul 22 23:05:08 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT4_unlabeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT4_unlabeled.R2.trim_screen.txt
    jobid: 41
    wildcards: sample=WT4_unlabeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R2.trim.fastq.gz

Submitted job 41 with external jobid '19782951'.

[Thu Jul 22 23:05:10 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.minus.bam.flagstat
    jobid: 154
    wildcards: sample=WT4_unlabeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix WT4_unlabeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_WT4_unlabeled 	--sjdbOverhang ${readlength}
rm -rf WT4_unlabeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.Aligned.out.bam > ${tmpdir}/WT4_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/WT4_unlabeled.post_secondary_supplementary_filter.bam ${tmpdir}/WT4_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/WT4_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/WT4_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/WT4_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/WT4_unlabeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT4_unlabeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/WT4_unlabeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/WT4_unlabeled.post_insertion_filter.bam  O=${tmpdir}/WT4_unlabeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/WT4_unlabeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT4_unlabeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.bam > ${tmpdir}/WT4_unlabeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.bam > ${tmpdir}/WT4_unlabeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.bam > ${tmpdir}/WT4_unlabeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT4_unlabeled.F.bam ${tmpdir}/WT4_unlabeled.F1.bam ${tmpdir}/WT4_unlabeled.F2.bam
#rm -f ${tmpdir}/WT4_unlabeled.F1.bam ${tmpdir}/WT4_unlabeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.bam > ${tmpdir}/WT4_unlabeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.bam > ${tmpdir}/WT4_unlabeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT4_unlabeled.R.bam ${tmpdir}/WT4_unlabeled.R1.bam ${tmpdir}/WT4_unlabeled.R2.bam
#rm -f ${tmpdir}/WT4_unlabeled.R1.bam ${tmpdir}/WT4_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.plus.bam ${tmpdir}/WT4_unlabeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.minus.bam ${tmpdir}/WT4_unlabeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_unlabeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/WT4_unlabeled.*
rm -rf _STARtmp


Submitted job 154 with external jobid '19782955'.

[Thu Jul 22 23:05:11 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam.flagstat
    jobid: 57
    wildcards: sample=WT4_unlabeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_unlabeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.hisat2.summary.log  --threads 56  --rg-id WT4_unlabeled --rg SM:WT4_unlabeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/WT4_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_unlabeled.post_secondary_supplementary_filter.bam /dev/shm/WT4_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/WT4_unlabeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/WT4_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT4_unlabeled.post_secondary_supplementary_filter.bam -o /dev/shm/WT4_unlabeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_unlabeled.post_insertion_filter.bam /dev/shm/WT4_unlabeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/WT4_unlabeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/WT4_unlabeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_unlabeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/WT4_unlabeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT4_unlabeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.bam > /dev/shm/WT4_unlabeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.bam > /dev/shm/WT4_unlabeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT4_unlabeled.F.bam /dev/shm/WT4_unlabeled.F1.bam /dev/shm/WT4_unlabeled.F2.bam && rm -f /dev/shm/WT4_unlabeled.F1.bam /dev/shm/WT4_unlabeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.bam > /dev/shm/WT4_unlabeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.bam > /dev/shm/WT4_unlabeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT4_unlabeled.R.bam /dev/shm/WT4_unlabeled.R1.bam /dev/shm/WT4_unlabeled.R2.bam && rm -f /dev/shm/WT4_unlabeled.R1.bam /dev/shm/WT4_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam /dev/shm/WT4_unlabeled.F.bam && rm -f /dev/shm/WT4_unlabeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam /dev/shm/WT4_unlabeled.R.bam && rm -f /dev/shm/WT4_unlabeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/WT4_unlabeled.*


Submitted job 57 with external jobid '19782958'.
[Thu Jul 22 23:06:56 2021]
Finished job 171.
18 of 196 steps (9%) done

[Thu Jul 22 23:06:56 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.vcf.gz
    jobid: 74
    wildcards: sample=SRA_labeled_1
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/SRA_labeled_1.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/SRA_labeled_1.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/SRA_labeled_1.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/SRA_labeled_1.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.vcf.gz

Submitted job 74 with external jobid '19783077'.
[Thu Jul 22 23:07:32 2021]
Finished job 174.
19 of 196 steps (10%) done

[Thu Jul 22 23:07:32 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.vcf.gz
    jobid: 77
    wildcards: sample=SRA_unlabeled_2
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/SRA_unlabeled_2.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/SRA_unlabeled_2.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/SRA_unlabeled_2.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/SRA_unlabeled_2.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.vcf.gz

Submitted job 77 with external jobid '19783288'.
[Thu Jul 22 23:07:44 2021]
Finished job 157.
20 of 196 steps (10%) done
[Thu Jul 22 23:11:44 2021]
Finished job 173.
21 of 196 steps (11%) done

[Thu Jul 22 23:11:44 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.vcf.gz
    jobid: 76
    wildcards: sample=SRA_unlabeled_1
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/SRA_unlabeled_1.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/SRA_unlabeled_1.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/SRA_unlabeled_1.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/SRA_unlabeled_1.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.vcf.gz

Submitted job 76 with external jobid '19783623'.
[Thu Jul 22 23:12:20 2021]
Finished job 158.
22 of 196 steps (11%) done
[Thu Jul 22 23:14:56 2021]
Finished job 155.
23 of 196 steps (12%) done
[Thu Jul 22 23:15:08 2021]
Finished job 59.
24 of 196 steps (12%) done

[Thu Jul 22 23:15:08 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_2.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.toSNPcalling.bam.flagstat
    jobid: 172
    wildcards: sample=SRA_labeled_2
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam -o /dev/shm/SRA_labeled_2.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_2.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.toSNPcalling.bam /dev/shm/SRA_labeled_2.plus.bam && rm -f /dev/shm/SRA_labeled_2.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam -o /dev/shm/SRA_labeled_2.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_2.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.toSNPcalling.bam /dev/shm/SRA_labeled_2.minus.bam && rm -f /dev/shm/SRA_labeled_2.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.toSNPcalling.bam.flagstat

Submitted job 172 with external jobid '19783943'.
[Thu Jul 22 23:15:56 2021]
Finished job 41.
25 of 196 steps (13%) done
[Thu Jul 22 23:16:51 2021]
Finished job 6.
26 of 196 steps (13%) done

[Thu Jul 22 23:16:51 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT3_unlabeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT3_unlabeled.R2.trim_screen.txt
    jobid: 39
    wildcards: sample=WT3_unlabeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R2.trim.fastq.gz

Submitted job 39 with external jobid '19784032'.

[Thu Jul 22 23:16:53 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.minus.bam.flagstat
    jobid: 152
    wildcards: sample=WT3_unlabeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix WT3_unlabeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_WT3_unlabeled 	--sjdbOverhang ${readlength}
rm -rf WT3_unlabeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.Aligned.out.bam > ${tmpdir}/WT3_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/WT3_unlabeled.post_secondary_supplementary_filter.bam ${tmpdir}/WT3_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/WT3_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/WT3_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/WT3_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/WT3_unlabeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT3_unlabeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/WT3_unlabeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/WT3_unlabeled.post_insertion_filter.bam  O=${tmpdir}/WT3_unlabeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/WT3_unlabeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT3_unlabeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.bam > ${tmpdir}/WT3_unlabeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.bam > ${tmpdir}/WT3_unlabeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.bam > ${tmpdir}/WT3_unlabeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT3_unlabeled.F.bam ${tmpdir}/WT3_unlabeled.F1.bam ${tmpdir}/WT3_unlabeled.F2.bam
#rm -f ${tmpdir}/WT3_unlabeled.F1.bam ${tmpdir}/WT3_unlabeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.bam > ${tmpdir}/WT3_unlabeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.bam > ${tmpdir}/WT3_unlabeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT3_unlabeled.R.bam ${tmpdir}/WT3_unlabeled.R1.bam ${tmpdir}/WT3_unlabeled.R2.bam
#rm -f ${tmpdir}/WT3_unlabeled.R1.bam ${tmpdir}/WT3_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.plus.bam ${tmpdir}/WT3_unlabeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.minus.bam ${tmpdir}/WT3_unlabeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_unlabeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/WT3_unlabeled.*
rm -rf _STARtmp


Submitted job 152 with external jobid '19784034'.

[Thu Jul 22 23:16:54 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam.flagstat
    jobid: 55
    wildcards: sample=WT3_unlabeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.hisat2.summary.log  --threads 56  --rg-id WT3_unlabeled --rg SM:WT3_unlabeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/WT3_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT3_unlabeled.post_secondary_supplementary_filter.bam /dev/shm/WT3_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/WT3_unlabeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/WT3_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT3_unlabeled.post_secondary_supplementary_filter.bam -o /dev/shm/WT3_unlabeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT3_unlabeled.post_insertion_filter.bam /dev/shm/WT3_unlabeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/WT3_unlabeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/WT3_unlabeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT3_unlabeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/WT3_unlabeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT3_unlabeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.bam > /dev/shm/WT3_unlabeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.bam > /dev/shm/WT3_unlabeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT3_unlabeled.F.bam /dev/shm/WT3_unlabeled.F1.bam /dev/shm/WT3_unlabeled.F2.bam && rm -f /dev/shm/WT3_unlabeled.F1.bam /dev/shm/WT3_unlabeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.bam > /dev/shm/WT3_unlabeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.bam > /dev/shm/WT3_unlabeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT3_unlabeled.R.bam /dev/shm/WT3_unlabeled.R1.bam /dev/shm/WT3_unlabeled.R2.bam && rm -f /dev/shm/WT3_unlabeled.R1.bam /dev/shm/WT3_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam /dev/shm/WT3_unlabeled.F.bam && rm -f /dev/shm/WT3_unlabeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam /dev/shm/WT3_unlabeled.R.bam && rm -f /dev/shm/WT3_unlabeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/WT3_unlabeled.*


Submitted job 55 with external jobid '19784036'.

[Thu Jul 22 23:16:55 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_unlabeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_unlabeled.fastuniq.readids
    jobid: 22
    wildcards: sample=WT3_unlabeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT3_unlabeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_unlabeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT3_unlabeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/WT3_unlabeled.R1.fastq" > /lscratch/${SLURM_JOBID}/WT3_unlabeled.list
echo "/lscratch/${SLURM_JOBID}/WT3_unlabeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/WT3_unlabeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/WT3_unlabeled.list -t q -o /lscratch/${SLURM_JOBID}/WT3_unlabeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/WT3_unlabeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/WT3_unlabeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_unlabeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/WT3_unlabeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT3_unlabeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_unlabeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/WT3_unlabeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT3_unlabeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_unlabeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 22 with external jobid '19784038'.
[Thu Jul 22 23:17:26 2021]
Finished job 4.
27 of 196 steps (14%) done

[Thu Jul 22 23:17:27 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.minus.bam.flagstat
    jobid: 150
    wildcards: sample=KO8_unlabeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix KO8_unlabeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_KO8_unlabeled 	--sjdbOverhang ${readlength}
rm -rf KO8_unlabeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.Aligned.out.bam > ${tmpdir}/KO8_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/KO8_unlabeled.post_secondary_supplementary_filter.bam ${tmpdir}/KO8_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/KO8_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/KO8_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/KO8_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/KO8_unlabeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO8_unlabeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/KO8_unlabeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/KO8_unlabeled.post_insertion_filter.bam  O=${tmpdir}/KO8_unlabeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/KO8_unlabeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO8_unlabeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.bam > ${tmpdir}/KO8_unlabeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.bam > ${tmpdir}/KO8_unlabeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.bam > ${tmpdir}/KO8_unlabeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO8_unlabeled.F.bam ${tmpdir}/KO8_unlabeled.F1.bam ${tmpdir}/KO8_unlabeled.F2.bam
#rm -f ${tmpdir}/KO8_unlabeled.F1.bam ${tmpdir}/KO8_unlabeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.bam > ${tmpdir}/KO8_unlabeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.bam > ${tmpdir}/KO8_unlabeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO8_unlabeled.R.bam ${tmpdir}/KO8_unlabeled.R1.bam ${tmpdir}/KO8_unlabeled.R2.bam
#rm -f ${tmpdir}/KO8_unlabeled.R1.bam ${tmpdir}/KO8_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.plus.bam ${tmpdir}/KO8_unlabeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.minus.bam ${tmpdir}/KO8_unlabeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_unlabeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/KO8_unlabeled.*
rm -rf _STARtmp


Submitted job 150 with external jobid '19784061'.

[Thu Jul 22 23:17:28 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam.flagstat
    jobid: 53
    wildcards: sample=KO8_unlabeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.hisat2.summary.log  --threads 56  --rg-id KO8_unlabeled --rg SM:KO8_unlabeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/KO8_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO8_unlabeled.post_secondary_supplementary_filter.bam /dev/shm/KO8_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/KO8_unlabeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/KO8_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO8_unlabeled.post_secondary_supplementary_filter.bam -o /dev/shm/KO8_unlabeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO8_unlabeled.post_insertion_filter.bam /dev/shm/KO8_unlabeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/KO8_unlabeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/KO8_unlabeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO8_unlabeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/KO8_unlabeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO8_unlabeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.bam > /dev/shm/KO8_unlabeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.bam > /dev/shm/KO8_unlabeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO8_unlabeled.F.bam /dev/shm/KO8_unlabeled.F1.bam /dev/shm/KO8_unlabeled.F2.bam && rm -f /dev/shm/KO8_unlabeled.F1.bam /dev/shm/KO8_unlabeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.bam > /dev/shm/KO8_unlabeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.bam > /dev/shm/KO8_unlabeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO8_unlabeled.R.bam /dev/shm/KO8_unlabeled.R1.bam /dev/shm/KO8_unlabeled.R2.bam && rm -f /dev/shm/KO8_unlabeled.R1.bam /dev/shm/KO8_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam /dev/shm/KO8_unlabeled.F.bam && rm -f /dev/shm/KO8_unlabeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam /dev/shm/KO8_unlabeled.R.bam && rm -f /dev/shm/KO8_unlabeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/KO8_unlabeled.*


Submitted job 53 with external jobid '19784063'.

[Thu Jul 22 23:17:29 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_unlabeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_unlabeled.fastuniq.readids
    jobid: 20
    wildcards: sample=KO8_unlabeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO8_unlabeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO8_unlabeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/KO8_unlabeled.R1.fastq" > /lscratch/${SLURM_JOBID}/KO8_unlabeled.list
echo "/lscratch/${SLURM_JOBID}/KO8_unlabeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/KO8_unlabeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/KO8_unlabeled.list -t q -o /lscratch/${SLURM_JOBID}/KO8_unlabeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/KO8_unlabeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/KO8_unlabeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_unlabeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/KO8_unlabeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO8_unlabeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_unlabeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/KO8_unlabeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO8_unlabeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_unlabeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 20 with external jobid '19784065'.

[Thu Jul 22 23:17:30 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO8_unlabeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO8_unlabeled.R2.trim_screen.txt
    jobid: 37
    wildcards: sample=KO8_unlabeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_unlabeled.R2.trim.fastq.gz

Submitted job 37 with external jobid '19784067'.
[Thu Jul 22 23:20:04 2021]
Finished job 156.
28 of 196 steps (14%) done
[Thu Jul 22 23:22:04 2021]
Finished job 172.
29 of 196 steps (15%) done

[Thu Jul 22 23:22:04 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.vcf.gz
    jobid: 75
    wildcards: sample=SRA_labeled_2
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/SRA_labeled_2.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/SRA_labeled_2.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/SRA_labeled_2.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/SRA_labeled_2.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.vcf.gz

Submitted job 75 with external jobid '19784511'.
[Thu Jul 22 23:24:03 2021]
Finished job 2.
30 of 196 steps (15%) done

[Thu Jul 22 23:24:03 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_unlabeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_unlabeled.fastuniq.readids
    jobid: 18
    wildcards: sample=KO1_unlabeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO1_unlabeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO1_unlabeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/KO1_unlabeled.R1.fastq" > /lscratch/${SLURM_JOBID}/KO1_unlabeled.list
echo "/lscratch/${SLURM_JOBID}/KO1_unlabeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/KO1_unlabeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/KO1_unlabeled.list -t q -o /lscratch/${SLURM_JOBID}/KO1_unlabeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/KO1_unlabeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/KO1_unlabeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_unlabeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/KO1_unlabeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO1_unlabeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_unlabeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/KO1_unlabeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO1_unlabeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_unlabeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 18 with external jobid '19784776'.

[Thu Jul 22 23:24:06 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO1_unlabeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO1_unlabeled.R2.trim_screen.txt
    jobid: 35
    wildcards: sample=KO1_unlabeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R2.trim.fastq.gz

Submitted job 35 with external jobid '19784778'.

[Thu Jul 22 23:24:09 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.minus.bam.flagstat
    jobid: 148
    wildcards: sample=KO1_unlabeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix KO1_unlabeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_KO1_unlabeled 	--sjdbOverhang ${readlength}
rm -rf KO1_unlabeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.Aligned.out.bam > ${tmpdir}/KO1_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/KO1_unlabeled.post_secondary_supplementary_filter.bam ${tmpdir}/KO1_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/KO1_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/KO1_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/KO1_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/KO1_unlabeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO1_unlabeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/KO1_unlabeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/KO1_unlabeled.post_insertion_filter.bam  O=${tmpdir}/KO1_unlabeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/KO1_unlabeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO1_unlabeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.bam > ${tmpdir}/KO1_unlabeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.bam > ${tmpdir}/KO1_unlabeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.bam > ${tmpdir}/KO1_unlabeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO1_unlabeled.F.bam ${tmpdir}/KO1_unlabeled.F1.bam ${tmpdir}/KO1_unlabeled.F2.bam
#rm -f ${tmpdir}/KO1_unlabeled.F1.bam ${tmpdir}/KO1_unlabeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.bam > ${tmpdir}/KO1_unlabeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.bam > ${tmpdir}/KO1_unlabeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO1_unlabeled.R.bam ${tmpdir}/KO1_unlabeled.R1.bam ${tmpdir}/KO1_unlabeled.R2.bam
#rm -f ${tmpdir}/KO1_unlabeled.R1.bam ${tmpdir}/KO1_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.plus.bam ${tmpdir}/KO1_unlabeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.minus.bam ${tmpdir}/KO1_unlabeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_unlabeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/KO1_unlabeled.*
rm -rf _STARtmp


Submitted job 148 with external jobid '19784780'.

[Thu Jul 22 23:24:11 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam.flagstat
    jobid: 51
    wildcards: sample=KO1_unlabeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_unlabeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.hisat2.summary.log  --threads 56  --rg-id KO1_unlabeled --rg SM:KO1_unlabeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/KO1_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_unlabeled.post_secondary_supplementary_filter.bam /dev/shm/KO1_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/KO1_unlabeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/KO1_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO1_unlabeled.post_secondary_supplementary_filter.bam -o /dev/shm/KO1_unlabeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_unlabeled.post_insertion_filter.bam /dev/shm/KO1_unlabeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/KO1_unlabeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/KO1_unlabeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_unlabeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/KO1_unlabeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO1_unlabeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.bam > /dev/shm/KO1_unlabeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.bam > /dev/shm/KO1_unlabeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO1_unlabeled.F.bam /dev/shm/KO1_unlabeled.F1.bam /dev/shm/KO1_unlabeled.F2.bam && rm -f /dev/shm/KO1_unlabeled.F1.bam /dev/shm/KO1_unlabeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.bam > /dev/shm/KO1_unlabeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.bam > /dev/shm/KO1_unlabeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO1_unlabeled.R.bam /dev/shm/KO1_unlabeled.R1.bam /dev/shm/KO1_unlabeled.R2.bam && rm -f /dev/shm/KO1_unlabeled.R1.bam /dev/shm/KO1_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam /dev/shm/KO1_unlabeled.F.bam && rm -f /dev/shm/KO1_unlabeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam /dev/shm/KO1_unlabeled.R.bam && rm -f /dev/shm/KO1_unlabeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/KO1_unlabeled.*


Submitted job 51 with external jobid '19784784'.
[Thu Jul 22 23:27:03 2021]
Finished job 24.
31 of 196 steps (16%) done
[Thu Jul 22 23:28:52 2021]
Finished job 39.
32 of 196 steps (16%) done
[Thu Jul 22 23:29:16 2021]
Finished job 77.
33 of 196 steps (17%) done

[Thu Jul 22 23:29:16 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat
    jobid: 93
    wildcards: sample=SRA_unlabeled_2
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam -o /dev/shm/SRA_unlabeled_2.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_2.plus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam -o /dev/shm/SRA_unlabeled_2.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_2.minus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat

Submitted job 93 with external jobid '19785125'.
[Thu Jul 22 23:30:52 2021]
Finished job 74.
34 of 196 steps (17%) done

[Thu Jul 22 23:30:53 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat
    jobid: 90
    wildcards: sample=SRA_labeled_1
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam -o /dev/shm/SRA_labeled_1.mutated.plus.bam --readids /dev/shm/SRA_labeled_1.plus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam -o /dev/shm/SRA_labeled_1.mutated.minus.bam --readids /dev/shm/SRA_labeled_1.minus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.bam && rm -f /dev/shm/SRA_labeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat

Submitted job 90 with external jobid '19785194'.
[Thu Jul 22 23:33:53 2021]
Finished job 37.
35 of 196 steps (18%) done
[Thu Jul 22 23:34:16 2021]
Finished job 14.
36 of 196 steps (18%) done

[Thu Jul 22 23:34:16 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO1_techrep2_unlabeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO1_techrep2_unlabeled.R2.trim_screen.txt
    jobid: 47
    wildcards: sample=KO1_techrep2_unlabeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R2.trim.fastq.gz

Submitted job 47 with external jobid '19785330'.

[Thu Jul 22 23:34:17 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.minus.bam.flagstat
    jobid: 160
    wildcards: sample=KO1_techrep2_unlabeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix KO1_techrep2_unlabeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_KO1_techrep2_unlabeled 	--sjdbOverhang ${readlength}
rm -rf KO1_techrep2_unlabeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.Aligned.out.bam > ${tmpdir}/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.bam ${tmpdir}/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/KO1_techrep2_unlabeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/KO1_techrep2_unlabeled.post_insertion_filter.bam  O=${tmpdir}/KO1_techrep2_unlabeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/KO1_techrep2_unlabeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO1_techrep2_unlabeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.bam > ${tmpdir}/KO1_techrep2_unlabeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.bam > ${tmpdir}/KO1_techrep2_unlabeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.bam > ${tmpdir}/KO1_techrep2_unlabeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO1_techrep2_unlabeled.F.bam ${tmpdir}/KO1_techrep2_unlabeled.F1.bam ${tmpdir}/KO1_techrep2_unlabeled.F2.bam
#rm -f ${tmpdir}/KO1_techrep2_unlabeled.F1.bam ${tmpdir}/KO1_techrep2_unlabeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.bam > ${tmpdir}/KO1_techrep2_unlabeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.bam > ${tmpdir}/KO1_techrep2_unlabeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO1_techrep2_unlabeled.R.bam ${tmpdir}/KO1_techrep2_unlabeled.R1.bam ${tmpdir}/KO1_techrep2_unlabeled.R2.bam
#rm -f ${tmpdir}/KO1_techrep2_unlabeled.R1.bam ${tmpdir}/KO1_techrep2_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.plus.bam ${tmpdir}/KO1_techrep2_unlabeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.minus.bam ${tmpdir}/KO1_techrep2_unlabeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep2_unlabeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/KO1_techrep2_unlabeled.*
rm -rf _STARtmp


Submitted job 160 with external jobid '19785332'.

[Thu Jul 22 23:34:21 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam.flagstat
    jobid: 63
    wildcards: sample=KO1_techrep2_unlabeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.hisat2.summary.log  --threads 56  --rg-id KO1_techrep2_unlabeled --rg SM:KO1_techrep2_unlabeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.bam /dev/shm/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO1_techrep2_unlabeled.post_secondary_supplementary_filter.bam -o /dev/shm/KO1_techrep2_unlabeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_techrep2_unlabeled.post_insertion_filter.bam /dev/shm/KO1_techrep2_unlabeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/KO1_techrep2_unlabeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_techrep2_unlabeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/KO1_techrep2_unlabeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO1_techrep2_unlabeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.bam > /dev/shm/KO1_techrep2_unlabeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.bam > /dev/shm/KO1_techrep2_unlabeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO1_techrep2_unlabeled.F.bam /dev/shm/KO1_techrep2_unlabeled.F1.bam /dev/shm/KO1_techrep2_unlabeled.F2.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.F1.bam /dev/shm/KO1_techrep2_unlabeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.bam > /dev/shm/KO1_techrep2_unlabeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.bam > /dev/shm/KO1_techrep2_unlabeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO1_techrep2_unlabeled.R.bam /dev/shm/KO1_techrep2_unlabeled.R1.bam /dev/shm/KO1_techrep2_unlabeled.R2.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.R1.bam /dev/shm/KO1_techrep2_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam /dev/shm/KO1_techrep2_unlabeled.F.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam /dev/shm/KO1_techrep2_unlabeled.R.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/KO1_techrep2_unlabeled.*


Submitted job 63 with external jobid '19785334'.

[Thu Jul 22 23:34:22 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep2_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep2_unlabeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep2_unlabeled.fastuniq.readids
    jobid: 30
    wildcards: sample=KO1_techrep2_unlabeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep2_unlabeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.R1.fastq" > /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.list
echo "/lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.list -t q -o /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep2_unlabeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep2_unlabeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO1_techrep2_unlabeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep2_unlabeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 30 with external jobid '19785335'.
[Thu Jul 22 23:35:54 2021]
Error in rule split_bam_by_mutation:
    jobid: 93
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam -o /dev/shm/SRA_unlabeled_2.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_2.plus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam -o /dev/shm/SRA_unlabeled_2.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_2.minus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19785125

Error executing rule split_bam_by_mutation on cluster (jobid: 93, external: 19785125, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.93.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 93.
[Thu Jul 22 23:35:54 2021]
Error in rule split_bam_by_mutation:
    jobid: 90
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam -o /dev/shm/SRA_labeled_1.mutated.plus.bam --readids /dev/shm/SRA_labeled_1.plus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam -o /dev/shm/SRA_labeled_1.mutated.minus.bam --readids /dev/shm/SRA_labeled_1.minus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.bam && rm -f /dev/shm/SRA_labeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19785194

Error executing rule split_bam_by_mutation on cluster (jobid: 90, external: 19785194, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.90.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 90.

[Thu Jul 22 23:35:54 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat
    jobid: 93
    wildcards: sample=SRA_unlabeled_2
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam -o /dev/shm/SRA_unlabeled_2.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_2.plus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam -o /dev/shm/SRA_unlabeled_2.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_2.minus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat

Submitted job 93 with external jobid '19785404'.

[Thu Jul 22 23:35:58 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat
    jobid: 90
    wildcards: sample=SRA_labeled_1
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam -o /dev/shm/SRA_labeled_1.mutated.plus.bam --readids /dev/shm/SRA_labeled_1.plus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam -o /dev/shm/SRA_labeled_1.mutated.minus.bam --readids /dev/shm/SRA_labeled_1.minus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.bam && rm -f /dev/shm/SRA_labeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat

Submitted job 90 with external jobid '19785406'.
[Thu Jul 22 23:36:17 2021]
Finished job 35.
37 of 196 steps (19%) done
[Thu Jul 22 23:38:42 2021]
Error in rule split_bam_by_mutation:
    jobid: 93
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam -o /dev/shm/SRA_unlabeled_2.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_2.plus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam -o /dev/shm/SRA_unlabeled_2.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_2.minus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19785404

Error executing rule split_bam_by_mutation on cluster (jobid: 93, external: 19785404, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.93.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 93.
[Thu Jul 22 23:38:42 2021]
Error in rule split_bam_by_mutation:
    jobid: 90
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam -o /dev/shm/SRA_labeled_1.mutated.plus.bam --readids /dev/shm/SRA_labeled_1.plus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam -o /dev/shm/SRA_labeled_1.mutated.minus.bam --readids /dev/shm/SRA_labeled_1.minus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.bam && rm -f /dev/shm/SRA_labeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19785406

Error executing rule split_bam_by_mutation on cluster (jobid: 90, external: 19785406, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.90.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 90.

[Thu Jul 22 23:38:42 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat
    jobid: 93
    wildcards: sample=SRA_unlabeled_2
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam -o /dev/shm/SRA_unlabeled_2.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_2.plus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam -o /dev/shm/SRA_unlabeled_2.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_2.minus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat

Submitted job 93 with external jobid '19785552'.

[Thu Jul 22 23:38:44 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat
    jobid: 90
    wildcards: sample=SRA_labeled_1
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam -o /dev/shm/SRA_labeled_1.mutated.plus.bam --readids /dev/shm/SRA_labeled_1.plus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam -o /dev/shm/SRA_labeled_1.mutated.minus.bam --readids /dev/shm/SRA_labeled_1.minus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.bam && rm -f /dev/shm/SRA_labeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat

Submitted job 90 with external jobid '19785554'.
[Thu Jul 22 23:40:16 2021]
Finished job 16.
38 of 196 steps (19%) done

[Thu Jul 22 23:40:16 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep2_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep2_unlabeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep2_unlabeled.fastuniq.readids
    jobid: 32
    wildcards: sample=WT4_techrep2_unlabeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.R1.fastq" > /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.list
echo "/lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.list -t q -o /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep2_unlabeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep2_unlabeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT4_techrep2_unlabeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep2_unlabeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 32 with external jobid '19785804'.

[Thu Jul 22 23:40:20 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT4_techrep2_unlabeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT4_techrep2_unlabeled.R2.trim_screen.txt
    jobid: 49
    wildcards: sample=WT4_techrep2_unlabeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R2.trim.fastq.gz

Submitted job 49 with external jobid '19785809'.

[Thu Jul 22 23:40:21 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.minus.bam.flagstat
    jobid: 162
    wildcards: sample=WT4_techrep2_unlabeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix WT4_techrep2_unlabeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_WT4_techrep2_unlabeled 	--sjdbOverhang ${readlength}
rm -rf WT4_techrep2_unlabeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.Aligned.out.bam > ${tmpdir}/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.bam ${tmpdir}/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/WT4_techrep2_unlabeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/WT4_techrep2_unlabeled.post_insertion_filter.bam  O=${tmpdir}/WT4_techrep2_unlabeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/WT4_techrep2_unlabeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT4_techrep2_unlabeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.bam > ${tmpdir}/WT4_techrep2_unlabeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.bam > ${tmpdir}/WT4_techrep2_unlabeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.bam > ${tmpdir}/WT4_techrep2_unlabeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT4_techrep2_unlabeled.F.bam ${tmpdir}/WT4_techrep2_unlabeled.F1.bam ${tmpdir}/WT4_techrep2_unlabeled.F2.bam
#rm -f ${tmpdir}/WT4_techrep2_unlabeled.F1.bam ${tmpdir}/WT4_techrep2_unlabeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.bam > ${tmpdir}/WT4_techrep2_unlabeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.bam > ${tmpdir}/WT4_techrep2_unlabeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT4_techrep2_unlabeled.R.bam ${tmpdir}/WT4_techrep2_unlabeled.R1.bam ${tmpdir}/WT4_techrep2_unlabeled.R2.bam
#rm -f ${tmpdir}/WT4_techrep2_unlabeled.R1.bam ${tmpdir}/WT4_techrep2_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.plus.bam ${tmpdir}/WT4_techrep2_unlabeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.minus.bam ${tmpdir}/WT4_techrep2_unlabeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep2_unlabeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/WT4_techrep2_unlabeled.*
rm -rf _STARtmp


Submitted job 162 with external jobid '19785811'.

[Thu Jul 22 23:40:23 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam.flagstat
    jobid: 65
    wildcards: sample=WT4_techrep2_unlabeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep2_unlabeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.hisat2.summary.log  --threads 56  --rg-id WT4_techrep2_unlabeled --rg SM:WT4_techrep2_unlabeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.bam /dev/shm/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT4_techrep2_unlabeled.post_secondary_supplementary_filter.bam -o /dev/shm/WT4_techrep2_unlabeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_techrep2_unlabeled.post_insertion_filter.bam /dev/shm/WT4_techrep2_unlabeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/WT4_techrep2_unlabeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_techrep2_unlabeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/WT4_techrep2_unlabeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT4_techrep2_unlabeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.bam > /dev/shm/WT4_techrep2_unlabeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.bam > /dev/shm/WT4_techrep2_unlabeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT4_techrep2_unlabeled.F.bam /dev/shm/WT4_techrep2_unlabeled.F1.bam /dev/shm/WT4_techrep2_unlabeled.F2.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.F1.bam /dev/shm/WT4_techrep2_unlabeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.bam > /dev/shm/WT4_techrep2_unlabeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.bam > /dev/shm/WT4_techrep2_unlabeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT4_techrep2_unlabeled.R.bam /dev/shm/WT4_techrep2_unlabeled.R1.bam /dev/shm/WT4_techrep2_unlabeled.R2.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.R1.bam /dev/shm/WT4_techrep2_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam /dev/shm/WT4_techrep2_unlabeled.F.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam /dev/shm/WT4_techrep2_unlabeled.R.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/WT4_techrep2_unlabeled.*


Submitted job 65 with external jobid '19785815'.
[Thu Jul 22 23:42:30 2021]
Error in rule split_bam_by_mutation:
    jobid: 93
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.plus.bam -o /dev/shm/SRA_unlabeled_2.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_2.plus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_2.minus.bam -o /dev/shm/SRA_unlabeled_2.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_2.minus.readids -o2 /dev/shm/SRA_unlabeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.plus.bam /dev/shm/SRA_unlabeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam /dev/shm/SRA_unlabeled_2.mutated.bam && rm -f /dev/shm/SRA_unlabeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.plus.bam /dev/shm/SRA_unlabeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam /dev/shm/SRA_unlabeled_2.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19785552

Error executing rule split_bam_by_mutation on cluster (jobid: 93, external: 19785552, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.93.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Thu Jul 22 23:42:30 2021]
Error in rule split_bam_by_mutation:
    jobid: 90
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.plus.bam -o /dev/shm/SRA_labeled_1.mutated.plus.bam --readids /dev/shm/SRA_labeled_1.plus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_1.minus.bam -o /dev/shm/SRA_labeled_1.mutated.minus.bam --readids /dev/shm/SRA_labeled_1.minus.readids -o2 /dev/shm/SRA_labeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.mutated.plus.bam /dev/shm/SRA_labeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam /dev/shm/SRA_labeled_1.mutated.bam && rm -f /dev/shm/SRA_labeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.plus.bam /dev/shm/SRA_labeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam /dev/shm/SRA_labeled_1.unmutated.bam && rm -f /dev/shm/SRA_labeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19785554

Error executing rule split_bam_by_mutation on cluster (jobid: 90, external: 19785554, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.90.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Thu Jul 22 23:43:40 2021]
Finished job 1.
39 of 196 steps (20%) done

[Thu Jul 22 23:43:40 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO1_4SU_labeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO1_4SU_labeled.R2.trim_screen.txt
    jobid: 34
    wildcards: sample=KO1_4SU_labeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R2.trim.fastq.gz

Submitted job 34 with external jobid '19786186'.

[Thu Jul 22 23:43:44 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.minus.bam.flagstat
    jobid: 147
    wildcards: sample=KO1_4SU_labeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix KO1_4SU_labeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_KO1_4SU_labeled 	--sjdbOverhang ${readlength}
rm -rf KO1_4SU_labeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.Aligned.out.bam > ${tmpdir}/KO1_4SU_labeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/KO1_4SU_labeled.post_secondary_supplementary_filter.bam ${tmpdir}/KO1_4SU_labeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/KO1_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/KO1_4SU_labeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/KO1_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/KO1_4SU_labeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO1_4SU_labeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/KO1_4SU_labeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/KO1_4SU_labeled.post_insertion_filter.bam  O=${tmpdir}/KO1_4SU_labeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/KO1_4SU_labeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO1_4SU_labeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.bam > ${tmpdir}/KO1_4SU_labeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.bam > ${tmpdir}/KO1_4SU_labeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.bam > ${tmpdir}/KO1_4SU_labeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO1_4SU_labeled.F.bam ${tmpdir}/KO1_4SU_labeled.F1.bam ${tmpdir}/KO1_4SU_labeled.F2.bam
#rm -f ${tmpdir}/KO1_4SU_labeled.F1.bam ${tmpdir}/KO1_4SU_labeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.bam > ${tmpdir}/KO1_4SU_labeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.bam > ${tmpdir}/KO1_4SU_labeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO1_4SU_labeled.R.bam ${tmpdir}/KO1_4SU_labeled.R1.bam ${tmpdir}/KO1_4SU_labeled.R2.bam
#rm -f ${tmpdir}/KO1_4SU_labeled.R1.bam ${tmpdir}/KO1_4SU_labeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.plus.bam ${tmpdir}/KO1_4SU_labeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.minus.bam ${tmpdir}/KO1_4SU_labeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_4SU_labeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/KO1_4SU_labeled.*
rm -rf _STARtmp


Submitted job 147 with external jobid '19786188'.

[Thu Jul 22 23:43:48 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam.flagstat
    jobid: 50
    wildcards: sample=KO1_4SU_labeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.hisat2.summary.log  --threads 56  --rg-id KO1_4SU_labeled --rg SM:KO1_4SU_labeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/KO1_4SU_labeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_4SU_labeled.post_secondary_supplementary_filter.bam /dev/shm/KO1_4SU_labeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/KO1_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/KO1_4SU_labeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO1_4SU_labeled.post_secondary_supplementary_filter.bam -o /dev/shm/KO1_4SU_labeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_4SU_labeled.post_insertion_filter.bam /dev/shm/KO1_4SU_labeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/KO1_4SU_labeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/KO1_4SU_labeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_4SU_labeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/KO1_4SU_labeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO1_4SU_labeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.bam > /dev/shm/KO1_4SU_labeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.bam > /dev/shm/KO1_4SU_labeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO1_4SU_labeled.F.bam /dev/shm/KO1_4SU_labeled.F1.bam /dev/shm/KO1_4SU_labeled.F2.bam && rm -f /dev/shm/KO1_4SU_labeled.F1.bam /dev/shm/KO1_4SU_labeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.bam > /dev/shm/KO1_4SU_labeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.bam > /dev/shm/KO1_4SU_labeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO1_4SU_labeled.R.bam /dev/shm/KO1_4SU_labeled.R1.bam /dev/shm/KO1_4SU_labeled.R2.bam && rm -f /dev/shm/KO1_4SU_labeled.R1.bam /dev/shm/KO1_4SU_labeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam /dev/shm/KO1_4SU_labeled.F.bam && rm -f /dev/shm/KO1_4SU_labeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam /dev/shm/KO1_4SU_labeled.R.bam && rm -f /dev/shm/KO1_4SU_labeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/KO1_4SU_labeled.*


Submitted job 50 with external jobid '19786191'.

[Thu Jul 22 23:43:55 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_4SU_labeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_4SU_labeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_4SU_labeled.fastuniq.readids
    jobid: 17
    wildcards: sample=KO1_4SU_labeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_4SU_labeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/KO1_4SU_labeled.R1.fastq" > /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.list
echo "/lscratch/${SLURM_JOBID}/KO1_4SU_labeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.list -t q -o /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_4SU_labeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_4SU_labeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO1_4SU_labeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_4SU_labeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 17 with external jobid '19786193'.
[Thu Jul 22 23:44:57 2021]
Finished job 76.
40 of 196 steps (20%) done

[Thu Jul 22 23:44:57 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat
    jobid: 92
    wildcards: sample=SRA_unlabeled_1
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam -o /dev/shm/SRA_unlabeled_1.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_1.plus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam -o /dev/shm/SRA_unlabeled_1.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_1.minus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat

Submitted job 92 with external jobid '19786233'.
[Thu Jul 22 23:45:24 2021]
Finished job 75.
41 of 196 steps (21%) done

[Thu Jul 22 23:45:24 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat
    jobid: 91
    wildcards: sample=SRA_labeled_2
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam -o /dev/shm/SRA_labeled_2.mutated.plus.bam --readids /dev/shm/SRA_labeled_2.plus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam -o /dev/shm/SRA_labeled_2.mutated.minus.bam --readids /dev/shm/SRA_labeled_2.minus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.bam && rm -f /dev/shm/SRA_labeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat

Submitted job 91 with external jobid '19786252'.
[Thu Jul 22 23:47:34 2021]
Finished job 22.
42 of 196 steps (21%) done
[Thu Jul 22 23:47:46 2021]
Error in rule split_bam_by_mutation:
    jobid: 92
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam -o /dev/shm/SRA_unlabeled_1.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_1.plus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam -o /dev/shm/SRA_unlabeled_1.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_1.minus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19786233

Error executing rule split_bam_by_mutation on cluster (jobid: 92, external: 19786233, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.92.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 92.

[Thu Jul 22 23:47:46 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat
    jobid: 92
    wildcards: sample=SRA_unlabeled_1
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam -o /dev/shm/SRA_unlabeled_1.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_1.plus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam -o /dev/shm/SRA_unlabeled_1.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_1.minus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat

[Thu Jul 22 23:47:48 2021]
Error in rule split_bam_by_mutation:
    jobid: 91
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam -o /dev/shm/SRA_labeled_2.mutated.plus.bam --readids /dev/shm/SRA_labeled_2.plus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam -o /dev/shm/SRA_labeled_2.mutated.minus.bam --readids /dev/shm/SRA_labeled_2.minus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.bam && rm -f /dev/shm/SRA_labeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19786252

Error executing rule split_bam_by_mutation on cluster (jobid: 91, external: 19786252, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.91.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 91.
Submitted job 92 with external jobid '19786354'.

[Thu Jul 22 23:47:50 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat
    jobid: 91
    wildcards: sample=SRA_labeled_2
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam -o /dev/shm/SRA_labeled_2.mutated.plus.bam --readids /dev/shm/SRA_labeled_2.plus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam -o /dev/shm/SRA_labeled_2.mutated.minus.bam --readids /dev/shm/SRA_labeled_2.minus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.bam && rm -f /dev/shm/SRA_labeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat

Submitted job 91 with external jobid '19786364'.
[Thu Jul 22 23:50:48 2021]
Error in rule split_bam_by_mutation:
    jobid: 92
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam -o /dev/shm/SRA_unlabeled_1.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_1.plus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam -o /dev/shm/SRA_unlabeled_1.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_1.minus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19786354

Error executing rule split_bam_by_mutation on cluster (jobid: 92, external: 19786354, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.92.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 92.
[Thu Jul 22 23:50:48 2021]
Error in rule split_bam_by_mutation:
    jobid: 91
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam -o /dev/shm/SRA_labeled_2.mutated.plus.bam --readids /dev/shm/SRA_labeled_2.plus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam -o /dev/shm/SRA_labeled_2.mutated.minus.bam --readids /dev/shm/SRA_labeled_2.minus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.bam && rm -f /dev/shm/SRA_labeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19786364

Error executing rule split_bam_by_mutation on cluster (jobid: 91, external: 19786364, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.91.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 91.

[Thu Jul 22 23:50:48 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat
    jobid: 92
    wildcards: sample=SRA_unlabeled_1
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam -o /dev/shm/SRA_unlabeled_1.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_1.plus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam -o /dev/shm/SRA_unlabeled_1.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_1.minus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat

Submitted job 92 with external jobid '19786482'.

[Thu Jul 22 23:50:49 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat
    jobid: 91
    wildcards: sample=SRA_labeled_2
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam -o /dev/shm/SRA_labeled_2.mutated.plus.bam --readids /dev/shm/SRA_labeled_2.plus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam -o /dev/shm/SRA_labeled_2.mutated.minus.bam --readids /dev/shm/SRA_labeled_2.minus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.bam && rm -f /dev/shm/SRA_labeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat

Submitted job 91 with external jobid '19786484'.
[Thu Jul 22 23:51:10 2021]
Finished job 13.
43 of 196 steps (22%) done

[Thu Jul 22 23:51:10 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO1_techrep1_unlabeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO1_techrep1_unlabeled.R2.trim_screen.txt
    jobid: 46
    wildcards: sample=KO1_techrep1_unlabeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R2.trim.fastq.gz

Submitted job 46 with external jobid '19786499'.

[Thu Jul 22 23:51:11 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.minus.bam.flagstat
    jobid: 159
    wildcards: sample=KO1_techrep1_unlabeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix KO1_techrep1_unlabeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_KO1_techrep1_unlabeled 	--sjdbOverhang ${readlength}
rm -rf KO1_techrep1_unlabeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.Aligned.out.bam > ${tmpdir}/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.bam ${tmpdir}/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/KO1_techrep1_unlabeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/KO1_techrep1_unlabeled.post_insertion_filter.bam  O=${tmpdir}/KO1_techrep1_unlabeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/KO1_techrep1_unlabeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO1_techrep1_unlabeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.bam > ${tmpdir}/KO1_techrep1_unlabeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.bam > ${tmpdir}/KO1_techrep1_unlabeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.bam > ${tmpdir}/KO1_techrep1_unlabeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO1_techrep1_unlabeled.F.bam ${tmpdir}/KO1_techrep1_unlabeled.F1.bam ${tmpdir}/KO1_techrep1_unlabeled.F2.bam
#rm -f ${tmpdir}/KO1_techrep1_unlabeled.F1.bam ${tmpdir}/KO1_techrep1_unlabeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.bam > ${tmpdir}/KO1_techrep1_unlabeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.bam > ${tmpdir}/KO1_techrep1_unlabeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO1_techrep1_unlabeled.R.bam ${tmpdir}/KO1_techrep1_unlabeled.R1.bam ${tmpdir}/KO1_techrep1_unlabeled.R2.bam
#rm -f ${tmpdir}/KO1_techrep1_unlabeled.R1.bam ${tmpdir}/KO1_techrep1_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.plus.bam ${tmpdir}/KO1_techrep1_unlabeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.minus.bam ${tmpdir}/KO1_techrep1_unlabeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO1_techrep1_unlabeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/KO1_techrep1_unlabeled.*
rm -rf _STARtmp


Submitted job 159 with external jobid '19786501'.

[Thu Jul 22 23:51:13 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam.flagstat
    jobid: 62
    wildcards: sample=KO1_techrep1_unlabeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.hisat2.summary.log  --threads 56  --rg-id KO1_techrep1_unlabeled --rg SM:KO1_techrep1_unlabeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.bam /dev/shm/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO1_techrep1_unlabeled.post_secondary_supplementary_filter.bam -o /dev/shm/KO1_techrep1_unlabeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_techrep1_unlabeled.post_insertion_filter.bam /dev/shm/KO1_techrep1_unlabeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/KO1_techrep1_unlabeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO1_techrep1_unlabeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/KO1_techrep1_unlabeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO1_techrep1_unlabeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.bam > /dev/shm/KO1_techrep1_unlabeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.bam > /dev/shm/KO1_techrep1_unlabeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO1_techrep1_unlabeled.F.bam /dev/shm/KO1_techrep1_unlabeled.F1.bam /dev/shm/KO1_techrep1_unlabeled.F2.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.F1.bam /dev/shm/KO1_techrep1_unlabeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.bam > /dev/shm/KO1_techrep1_unlabeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.bam > /dev/shm/KO1_techrep1_unlabeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO1_techrep1_unlabeled.R.bam /dev/shm/KO1_techrep1_unlabeled.R1.bam /dev/shm/KO1_techrep1_unlabeled.R2.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.R1.bam /dev/shm/KO1_techrep1_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam /dev/shm/KO1_techrep1_unlabeled.F.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam /dev/shm/KO1_techrep1_unlabeled.R.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/KO1_techrep1_unlabeled.*


Submitted job 62 with external jobid '19786504'.

[Thu Jul 22 23:51:14 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep1_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep1_unlabeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep1_unlabeled.fastuniq.readids
    jobid: 29
    wildcards: sample=KO1_techrep1_unlabeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO1_techrep1_unlabeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.R1.fastq" > /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.list
echo "/lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.list -t q -o /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep1_unlabeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep1_unlabeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO1_techrep1_unlabeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep1_unlabeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 29 with external jobid '19786506'.
[Thu Jul 22 23:51:22 2021]
Finished job 47.
44 of 196 steps (22%) done
[Thu Jul 22 23:51:24 2021]
Error in rule split_bam_by_mutation:
    jobid: 92
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_unlabeled_1.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_unlabeled_1.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_unlabeled_1.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.plus.bam -o /dev/shm/SRA_unlabeled_1.mutated.plus.bam --readids /dev/shm/SRA_unlabeled_1.plus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_unlabeled_1.minus.bam -o /dev/shm/SRA_unlabeled_1.mutated.minus.bam --readids /dev/shm/SRA_unlabeled_1.minus.readids -o2 /dev/shm/SRA_unlabeled_1.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.plus.bam /dev/shm/SRA_unlabeled_1.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam /dev/shm/SRA_unlabeled_1.mutated.bam && rm -f /dev/shm/SRA_unlabeled_1.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.plus.bam /dev/shm/SRA_unlabeled_1.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam /dev/shm/SRA_unlabeled_1.unmutated.bam && rm -f /dev/shm/SRA_unlabeled_1.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19786482

Error executing rule split_bam_by_mutation on cluster (jobid: 92, external: 19786482, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.92.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Thu Jul 22 23:51:24 2021]
Error in rule split_bam_by_mutation:
    jobid: 91
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/SRA_labeled_2.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/SRA_labeled_2.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/SRA_labeled_2.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.plus.bam -o /dev/shm/SRA_labeled_2.mutated.plus.bam --readids /dev/shm/SRA_labeled_2.plus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/SRA_labeled_2.minus.bam -o /dev/shm/SRA_labeled_2.mutated.minus.bam --readids /dev/shm/SRA_labeled_2.minus.readids -o2 /dev/shm/SRA_labeled_2.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.mutated.plus.bam /dev/shm/SRA_labeled_2.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam /dev/shm/SRA_labeled_2.mutated.bam && rm -f /dev/shm/SRA_labeled_2.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.plus.bam /dev/shm/SRA_labeled_2.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam /dev/shm/SRA_labeled_2.unmutated.bam && rm -f /dev/shm/SRA_labeled_2.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19786484

Error executing rule split_bam_by_mutation on cluster (jobid: 91, external: 19786484, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.91.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Thu Jul 22 23:52:23 2021]
Finished job 7.
45 of 196 steps (23%) done

[Thu Jul 22 23:52:23 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT4_4SU_labeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT4_4SU_labeled.R2.trim_screen.txt
    jobid: 40
    wildcards: sample=WT4_4SU_labeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R2.trim.fastq.gz

Submitted job 40 with external jobid '19786545'.

[Thu Jul 22 23:52:32 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.minus.bam.flagstat
    jobid: 153
    wildcards: sample=WT4_4SU_labeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix WT4_4SU_labeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_WT4_4SU_labeled 	--sjdbOverhang ${readlength}
rm -rf WT4_4SU_labeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.Aligned.out.bam > ${tmpdir}/WT4_4SU_labeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/WT4_4SU_labeled.post_secondary_supplementary_filter.bam ${tmpdir}/WT4_4SU_labeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/WT4_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/WT4_4SU_labeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/WT4_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/WT4_4SU_labeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT4_4SU_labeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/WT4_4SU_labeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/WT4_4SU_labeled.post_insertion_filter.bam  O=${tmpdir}/WT4_4SU_labeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/WT4_4SU_labeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT4_4SU_labeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.bam > ${tmpdir}/WT4_4SU_labeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.bam > ${tmpdir}/WT4_4SU_labeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.bam > ${tmpdir}/WT4_4SU_labeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT4_4SU_labeled.F.bam ${tmpdir}/WT4_4SU_labeled.F1.bam ${tmpdir}/WT4_4SU_labeled.F2.bam
#rm -f ${tmpdir}/WT4_4SU_labeled.F1.bam ${tmpdir}/WT4_4SU_labeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.bam > ${tmpdir}/WT4_4SU_labeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.bam > ${tmpdir}/WT4_4SU_labeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT4_4SU_labeled.R.bam ${tmpdir}/WT4_4SU_labeled.R1.bam ${tmpdir}/WT4_4SU_labeled.R2.bam
#rm -f ${tmpdir}/WT4_4SU_labeled.R1.bam ${tmpdir}/WT4_4SU_labeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.plus.bam ${tmpdir}/WT4_4SU_labeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.minus.bam ${tmpdir}/WT4_4SU_labeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_4SU_labeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/WT4_4SU_labeled.*
rm -rf _STARtmp


Submitted job 153 with external jobid '19786548'.

[Thu Jul 22 23:52:38 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam.flagstat
    jobid: 56
    wildcards: sample=WT4_4SU_labeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.hisat2.summary.log  --threads 56  --rg-id WT4_4SU_labeled --rg SM:WT4_4SU_labeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/WT4_4SU_labeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_4SU_labeled.post_secondary_supplementary_filter.bam /dev/shm/WT4_4SU_labeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/WT4_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/WT4_4SU_labeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT4_4SU_labeled.post_secondary_supplementary_filter.bam -o /dev/shm/WT4_4SU_labeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_4SU_labeled.post_insertion_filter.bam /dev/shm/WT4_4SU_labeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/WT4_4SU_labeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/WT4_4SU_labeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_4SU_labeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/WT4_4SU_labeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT4_4SU_labeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.bam > /dev/shm/WT4_4SU_labeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.bam > /dev/shm/WT4_4SU_labeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT4_4SU_labeled.F.bam /dev/shm/WT4_4SU_labeled.F1.bam /dev/shm/WT4_4SU_labeled.F2.bam && rm -f /dev/shm/WT4_4SU_labeled.F1.bam /dev/shm/WT4_4SU_labeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.bam > /dev/shm/WT4_4SU_labeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.bam > /dev/shm/WT4_4SU_labeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT4_4SU_labeled.R.bam /dev/shm/WT4_4SU_labeled.R1.bam /dev/shm/WT4_4SU_labeled.R2.bam && rm -f /dev/shm/WT4_4SU_labeled.R1.bam /dev/shm/WT4_4SU_labeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam /dev/shm/WT4_4SU_labeled.F.bam && rm -f /dev/shm/WT4_4SU_labeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam /dev/shm/WT4_4SU_labeled.R.bam && rm -f /dev/shm/WT4_4SU_labeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/WT4_4SU_labeled.*


Submitted job 56 with external jobid '19786580'.

[Thu Jul 22 23:52:44 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_4SU_labeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_4SU_labeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_4SU_labeled.fastuniq.readids
    jobid: 23
    wildcards: sample=WT4_4SU_labeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_4SU_labeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/WT4_4SU_labeled.R1.fastq" > /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.list
echo "/lscratch/${SLURM_JOBID}/WT4_4SU_labeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.list -t q -o /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_4SU_labeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_4SU_labeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT4_4SU_labeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_4SU_labeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 23 with external jobid '19786664'.
[Thu Jul 22 23:54:32 2021]
Finished job 20.
46 of 196 steps (23%) done
[Thu Jul 22 23:54:44 2021]
Finished job 3.
47 of 196 steps (24%) done

[Thu Jul 22 23:54:44 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam.flagstat
    jobid: 52
    wildcards: sample=KO8_4SU_labeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.hisat2.summary.log  --threads 56  --rg-id KO8_4SU_labeled --rg SM:KO8_4SU_labeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/KO8_4SU_labeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO8_4SU_labeled.post_secondary_supplementary_filter.bam /dev/shm/KO8_4SU_labeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/KO8_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/KO8_4SU_labeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO8_4SU_labeled.post_secondary_supplementary_filter.bam -o /dev/shm/KO8_4SU_labeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO8_4SU_labeled.post_insertion_filter.bam /dev/shm/KO8_4SU_labeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/KO8_4SU_labeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/KO8_4SU_labeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/KO8_4SU_labeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/KO8_4SU_labeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/KO8_4SU_labeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.bam > /dev/shm/KO8_4SU_labeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.bam > /dev/shm/KO8_4SU_labeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO8_4SU_labeled.F.bam /dev/shm/KO8_4SU_labeled.F1.bam /dev/shm/KO8_4SU_labeled.F2.bam && rm -f /dev/shm/KO8_4SU_labeled.F1.bam /dev/shm/KO8_4SU_labeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.bam > /dev/shm/KO8_4SU_labeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.bam > /dev/shm/KO8_4SU_labeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/KO8_4SU_labeled.R.bam /dev/shm/KO8_4SU_labeled.R1.bam /dev/shm/KO8_4SU_labeled.R2.bam && rm -f /dev/shm/KO8_4SU_labeled.R1.bam /dev/shm/KO8_4SU_labeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam /dev/shm/KO8_4SU_labeled.F.bam && rm -f /dev/shm/KO8_4SU_labeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam /dev/shm/KO8_4SU_labeled.R.bam && rm -f /dev/shm/KO8_4SU_labeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/KO8_4SU_labeled.*


Submitted job 52 with external jobid '19786913'.

[Thu Jul 22 23:54:46 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_4SU_labeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_4SU_labeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_4SU_labeled.fastuniq.readids
    jobid: 19
    wildcards: sample=KO8_4SU_labeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/KO8_4SU_labeled.R1.fastq" > /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.list
echo "/lscratch/${SLURM_JOBID}/KO8_4SU_labeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.list -t q -o /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_4SU_labeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_4SU_labeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/KO8_4SU_labeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_4SU_labeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 19 with external jobid '19786915'.

[Thu Jul 22 23:54:47 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO8_4SU_labeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/KO8_4SU_labeled.R2.trim_screen.txt
    jobid: 36
    wildcards: sample=KO8_4SU_labeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R2.trim.fastq.gz

Submitted job 36 with external jobid '19786917'.

[Thu Jul 22 23:54:48 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.minus.bam.flagstat
    jobid: 149
    wildcards: sample=KO8_4SU_labeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/KO8_4SU_labeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix KO8_4SU_labeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_KO8_4SU_labeled 	--sjdbOverhang ${readlength}
rm -rf KO8_4SU_labeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.Aligned.out.bam > ${tmpdir}/KO8_4SU_labeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/KO8_4SU_labeled.post_secondary_supplementary_filter.bam ${tmpdir}/KO8_4SU_labeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/KO8_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/KO8_4SU_labeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/KO8_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/KO8_4SU_labeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO8_4SU_labeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/KO8_4SU_labeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/KO8_4SU_labeled.post_insertion_filter.bam  O=${tmpdir}/KO8_4SU_labeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/KO8_4SU_labeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/KO8_4SU_labeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.bam > ${tmpdir}/KO8_4SU_labeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.bam > ${tmpdir}/KO8_4SU_labeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.bam > ${tmpdir}/KO8_4SU_labeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO8_4SU_labeled.F.bam ${tmpdir}/KO8_4SU_labeled.F1.bam ${tmpdir}/KO8_4SU_labeled.F2.bam
#rm -f ${tmpdir}/KO8_4SU_labeled.F1.bam ${tmpdir}/KO8_4SU_labeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.bam > ${tmpdir}/KO8_4SU_labeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.bam > ${tmpdir}/KO8_4SU_labeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/KO8_4SU_labeled.R.bam ${tmpdir}/KO8_4SU_labeled.R1.bam ${tmpdir}/KO8_4SU_labeled.R2.bam
#rm -f ${tmpdir}/KO8_4SU_labeled.R1.bam ${tmpdir}/KO8_4SU_labeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.plus.bam ${tmpdir}/KO8_4SU_labeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.minus.bam ${tmpdir}/KO8_4SU_labeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/KO8_4SU_labeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/KO8_4SU_labeled.*
rm -rf _STARtmp


Submitted job 149 with external jobid '19786919'.
[Thu Jul 22 23:54:57 2021]
Finished job 15.
48 of 196 steps (24%) done

[Thu Jul 22 23:54:57 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT4_techrep1_unlabeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT4_techrep1_unlabeled.R2.trim_screen.txt
    jobid: 48
    wildcards: sample=WT4_techrep1_unlabeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R2.trim.fastq.gz

Submitted job 48 with external jobid '19786924'.

[Thu Jul 22 23:55:00 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep1_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep1_unlabeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep1_unlabeled.fastuniq.readids
    jobid: 31
    wildcards: sample=WT4_techrep1_unlabeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.R1.fastq" > /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.list
echo "/lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.list -t q -o /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep1_unlabeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep1_unlabeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT4_techrep1_unlabeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep1_unlabeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 31 with external jobid '19786927'.

[Thu Jul 22 23:55:05 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.minus.bam.flagstat
    jobid: 161
    wildcards: sample=WT4_techrep1_unlabeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix WT4_techrep1_unlabeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_WT4_techrep1_unlabeled 	--sjdbOverhang ${readlength}
rm -rf WT4_techrep1_unlabeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.Aligned.out.bam > ${tmpdir}/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.bam ${tmpdir}/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/WT4_techrep1_unlabeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/WT4_techrep1_unlabeled.post_insertion_filter.bam  O=${tmpdir}/WT4_techrep1_unlabeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/WT4_techrep1_unlabeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT4_techrep1_unlabeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.bam > ${tmpdir}/WT4_techrep1_unlabeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.bam > ${tmpdir}/WT4_techrep1_unlabeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.bam > ${tmpdir}/WT4_techrep1_unlabeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT4_techrep1_unlabeled.F.bam ${tmpdir}/WT4_techrep1_unlabeled.F1.bam ${tmpdir}/WT4_techrep1_unlabeled.F2.bam
#rm -f ${tmpdir}/WT4_techrep1_unlabeled.F1.bam ${tmpdir}/WT4_techrep1_unlabeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.bam > ${tmpdir}/WT4_techrep1_unlabeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.bam > ${tmpdir}/WT4_techrep1_unlabeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT4_techrep1_unlabeled.R.bam ${tmpdir}/WT4_techrep1_unlabeled.R1.bam ${tmpdir}/WT4_techrep1_unlabeled.R2.bam
#rm -f ${tmpdir}/WT4_techrep1_unlabeled.R1.bam ${tmpdir}/WT4_techrep1_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.plus.bam ${tmpdir}/WT4_techrep1_unlabeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.minus.bam ${tmpdir}/WT4_techrep1_unlabeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT4_techrep1_unlabeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/WT4_techrep1_unlabeled.*
rm -rf _STARtmp


Submitted job 161 with external jobid '19786931'.

[Thu Jul 22 23:55:15 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam.flagstat
    jobid: 64
    wildcards: sample=WT4_techrep1_unlabeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT4_techrep1_unlabeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.hisat2.summary.log  --threads 56  --rg-id WT4_techrep1_unlabeled --rg SM:WT4_techrep1_unlabeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.bam /dev/shm/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT4_techrep1_unlabeled.post_secondary_supplementary_filter.bam -o /dev/shm/WT4_techrep1_unlabeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_techrep1_unlabeled.post_insertion_filter.bam /dev/shm/WT4_techrep1_unlabeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/WT4_techrep1_unlabeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT4_techrep1_unlabeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/WT4_techrep1_unlabeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT4_techrep1_unlabeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.bam > /dev/shm/WT4_techrep1_unlabeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.bam > /dev/shm/WT4_techrep1_unlabeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT4_techrep1_unlabeled.F.bam /dev/shm/WT4_techrep1_unlabeled.F1.bam /dev/shm/WT4_techrep1_unlabeled.F2.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.F1.bam /dev/shm/WT4_techrep1_unlabeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.bam > /dev/shm/WT4_techrep1_unlabeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.bam > /dev/shm/WT4_techrep1_unlabeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT4_techrep1_unlabeled.R.bam /dev/shm/WT4_techrep1_unlabeled.R1.bam /dev/shm/WT4_techrep1_unlabeled.R2.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.R1.bam /dev/shm/WT4_techrep1_unlabeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam /dev/shm/WT4_techrep1_unlabeled.F.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam /dev/shm/WT4_techrep1_unlabeled.R.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/WT4_techrep1_unlabeled.*


Submitted job 64 with external jobid '19786933'.
[Thu Jul 22 23:56:16 2021]
Finished job 49.
49 of 196 steps (25%) done
[Thu Jul 22 23:57:20 2021]
Finished job 5.
50 of 196 steps (26%) done

[Thu Jul 22 23:57:21 2021]
rule fastq_screen:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT3_4SU_labeled.R1.trim_screen.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen/WT3_4SU_labeled.R2.trim_screen.txt
    jobid: 38
    wildcards: sample=WT3_4SU_labeled
    threads: 56


fastq_screen --conf /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastq_screen.conf  --outdir "/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/fastqscreen"  --threads 56 --subset 1000000  --aligner bowtie2 --force  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R1.trim.fastq.gz  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R2.trim.fastq.gz

Submitted job 38 with external jobid '19787100'.

[Thu Jul 22 23:57:22 2021]
rule star:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.Aligned.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.Aligned.toTranscriptome.out.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.minus.bam.flagstat
    jobid: 151
    wildcards: sample=WT3_4SU_labeled
    threads: 56


tmpdir=/lscratch/$SLURM_JOB_ID
cd /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star
# Align with STAR and remove secondary/supplementary alignments
readlength=$(
	zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R2.trim.fastq.gz | 	awk -v maxlen=100 'NR%4==2 {if (length($1) > maxlen+0) maxlen=length($1)}; 	END {print maxlen-1}'
)
STAR --genomeDir /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/STAR_index_mm10_plus_rDNA_plus_5S_id90_masked 	--outFilterIntronMotifs RemoveNoncanonicalUnannotated 	--outFilterType BySJout 	--readFilesIn /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R1.trim.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R2.trim.fastq.gz 	--readFilesCommand zcat 	--runThreadN 56 	--outFileNamePrefix WT3_4SU_labeled. 	--twopassMode Basic 	--sjdbGTFfile /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.v25.plus_rDNA.plus_5S.gtf 	--quantMode TranscriptomeSAM GeneCounts 	--outSAMtype BAM Unsorted 	--alignEndsProtrude 10 ConcordantPair 	--peOverlapNbasesMin 10 	--outTmpDir=/lscratch/$SLURM_JOB_ID/STARtmp_WT3_4SU_labeled 	--sjdbOverhang ${readlength}
rm -rf WT3_4SU_labeled._STAR*
samtools flagstat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.Aligned.out.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.bam.flagstat
# The above STAR command will generate WT4_techrep2_unlabeled.Aligned.out.bam and WT4_techrep2_unlabeled.Aligned.toTranscriptome.out.bam
samtools view -@56 -b -F 4 -F 256 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.Aligned.out.bam > ${tmpdir}/WT3_4SU_labeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
samtools sort -@56 --output-fmt BAM -o ${tmpdir}/WT3_4SU_labeled.post_secondary_supplementary_filter.bam ${tmpdir}/WT3_4SU_labeled.post_secondary_supplementary_filter.tmp.bam && rm -f ${tmpdir}/WT3_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
samtools flagstat -@56 ${tmpdir}/WT3_4SU_labeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat
rm -f ${tmpdir}/WT3_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
samtools index -@56 ${tmpdir}/WT3_4SU_labeled.post_secondary_supplementary_filter.bam

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT3_4SU_labeled.post_secondary_supplementary_filter.bam -o ${tmpdir}/WT3_4SU_labeled.post_insertion_filter.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation  I=${tmpdir}/WT3_4SU_labeled.post_insertion_filter.bam  O=${tmpdir}/WT3_4SU_labeled.postfixmate.bam  ASSUME_SORTED=false  CREATE_INDEX=true  SORT_ORDER=coordinate
samtools flagstat -@56 ${tmpdir}/WT3_4SU_labeled.postfixmate.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i ${tmpdir}/WT3_4SU_labeled.postfixmate.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.bam -q 3 -n 1000

# Index and collect stats
samtools index -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.bam > ${tmpdir}/WT3_4SU_labeled

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.bam > ${tmpdir}/WT3_4SU_labeled.F1.bam
samtools view -@56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.bam > ${tmpdir}/WT3_4SU_labeled.F2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT3_4SU_labeled.F.bam ${tmpdir}/WT3_4SU_labeled.F1.bam ${tmpdir}/WT3_4SU_labeled.F2.bam
#rm -f ${tmpdir}/WT3_4SU_labeled.F1.bam ${tmpdir}/WT3_4SU_labeled.F2.bam
samtools view -@56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.bam > ${tmpdir}/WT3_4SU_labeled.R1.bam
samtools view -@56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.bam > ${tmpdir}/WT3_4SU_labeled.R2.bam
samtools merge -c -f -p -@56 ${tmpdir}/WT3_4SU_labeled.R.bam ${tmpdir}/WT3_4SU_labeled.R1.bam ${tmpdir}/WT3_4SU_labeled.R2.bam
#rm -f ${tmpdir}/WT3_4SU_labeled.R1.bam ${tmpdir}/WT3_4SU_labeled.R2.bam

# Sort and collect stats for plus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.plus.bam ${tmpdir}/WT3_4SU_labeled.F.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
samtools sort -@56 --output-fmt BAM -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.minus.bam ${tmpdir}/WT3_4SU_labeled.R.bam
samtools flagstat -@56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/star/WT3_4SU_labeled.minus.bam.flagstat

# cleanup
rm -rf ${tmpdir}/WT3_4SU_labeled.*
rm -rf _STARtmp


Submitted job 151 with external jobid '19787103'.

[Thu Jul 22 23:57:23 2021]
rule hisat:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.post_insertion_filter.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam.flagstat
    jobid: 54
    wildcards: sample=WT3_4SU_labeled
    threads: 56


# Align with HISAT and remove secondary/supplementary alignments

hisat2  -x /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked  -1 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R1.trim.fastq.gz  -2 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R2.trim.fastq.gz  --rna-strandness RF  --known-splicesite-infile /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/mm10.splicesites.txt  --summary-file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.hisat2.summary.log  --threads 56  --rg-id WT3_4SU_labeled --rg SM:WT3_4SU_labeled  --un-gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.unmapped.fastq.gz  --mp 4,2  | samtools view -@56 -bS -F 4 -F 256 - > /dev/shm/WT3_4SU_labeled.post_secondary_supplementary_filter.tmp.bam

# Sort the "post_secondary_supplementary_filter" BAM and collect some stats
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT3_4SU_labeled.post_secondary_supplementary_filter.bam /dev/shm/WT3_4SU_labeled.post_secondary_supplementary_filter.tmp.bam && rm -f /dev/shm/WT3_4SU_labeled.post_secondary_supplementary_filter.tmp.bam
sambamba flagstat --nthreads=56 /dev/shm/WT3_4SU_labeled.post_secondary_supplementary_filter.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.post_secondary_supplementary_filter.bam.flagstat

# Apply the "number of insertions in read" filter
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT3_4SU_labeled.post_secondary_supplementary_filter.bam -o /dev/shm/WT3_4SU_labeled.post_insertion_filter.tmp.bam -q 0 -n 1

# Sort, FixMateInfo, collect stats
sambamba sort -n --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT3_4SU_labeled.post_insertion_filter.bam /dev/shm/WT3_4SU_labeled.post_insertion_filter.tmp.bam && rm -f /dev/shm/WT3_4SU_labeled.post_insertion_filter.tmp.bam
java -Xmx200g -jar $PICARDJARPATH/picard.jar FixMateInformation I=/dev/shm/WT3_4SU_labeled.post_insertion_filter.bam O=/dev/stdout ASSUME_SORTED=true QUIET=true  | sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/dev/shm/WT3_4SU_labeled.postsambambasort.bam /dev/stdin
sambamba flagstat --nthreads=56 /dev/shm/WT3_4SU_labeled.postsambambasort.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.post_insertion_filter.bam.flagstat

# Apply the MAPQ filter and remove "widowed" reads
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam.py -i /dev/shm/WT3_4SU_labeled.postsambambasort.bam -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.bam -q 3 -n 1000

# Index and collect stats
sambamba index --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.bam.flagstat

# Split reads into :
# 1. Reads originating from + strand fragments --> these will go for T-to-C mutation detection
#         R2
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R1
# 2. Reads originating from - strand fragments --> these will go for A-to-G mutation detection
#         R1
#       ------>
#     5'-------------------------------------------------3'
#     3'-------------------------------------------------5'
#                                                 <------
#                                                    R2

samtools view -@ 56 -b -f 128 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.bam > /dev/shm/WT3_4SU_labeled.F1.bam
samtools view -@ 56 -b -f 80 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.bam > /dev/shm/WT3_4SU_labeled.F2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT3_4SU_labeled.F.bam /dev/shm/WT3_4SU_labeled.F1.bam /dev/shm/WT3_4SU_labeled.F2.bam && rm -f /dev/shm/WT3_4SU_labeled.F1.bam /dev/shm/WT3_4SU_labeled.F2.bam
samtools view -@ 56 -b -f 144 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.bam > /dev/shm/WT3_4SU_labeled.R1.bam
samtools view -@ 56 -b -f 64 -F 16 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.bam > /dev/shm/WT3_4SU_labeled.R2.bam
samtools merge -c -f -p -@ 56 /dev/shm/WT3_4SU_labeled.R.bam /dev/shm/WT3_4SU_labeled.R1.bam /dev/shm/WT3_4SU_labeled.R2.bam && rm -f /dev/shm/WT3_4SU_labeled.R1.bam /dev/shm/WT3_4SU_labeled.R2.bam

# Sort and collect stats for plus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam /dev/shm/WT3_4SU_labeled.F.bam && rm -f /dev/shm/WT3_4SU_labeled.F.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam.flagstat

# Sort and collect stats for minus strand BAM
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=56 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam /dev/shm/WT3_4SU_labeled.R.bam && rm -f /dev/shm/WT3_4SU_labeled.R.bam
sambamba flagstat --nthreads=56 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam.flagstat

# cleanup
rm -rf /dev/shm/WT3_4SU_labeled.*


Submitted job 54 with external jobid '19787106'.

[Thu Jul 22 23:57:24 2021]
rule get_fastuniq_readids:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R1.trim.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R2.trim.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_4SU_labeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_4SU_labeled.R2.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_4SU_labeled.fastuniq.readids
    jobid: 21
    wildcards: sample=WT3_4SU_labeled
    threads: 56


zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R1.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.R1.fastq
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/WT3_4SU_labeled.R2.trim.fastq.gz > /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.R2.fastq
echo "/lscratch/${SLURM_JOBID}/WT3_4SU_labeled.R1.fastq" > /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.list
echo "/lscratch/${SLURM_JOBID}/WT3_4SU_labeled.R2.fastq" >> /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.list
/gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/fastuniq -i /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.list -t q -o /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.R1.trim.fastuniq.fastq -p /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.R2.trim.fastuniq.fastq -c 0
awk '{if (! ((FNR + 3) % 4)) { print(substr($1,2))}}' /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.R1.trim.fastuniq.fastq > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_4SU_labeled.fastuniq.readids
pigz -p4 /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.R1.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.R1.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_4SU_labeled.R1.trim.fastuniq.fastq.gz
pigz -p4 /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.R2.trim.fastuniq.fastq && mv /lscratch/${SLURM_JOBID}/WT3_4SU_labeled.R2.trim.fastuniq.fastq.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_4SU_labeled.R2.trim.fastuniq.fastq.gz

echo "DONE!"

Submitted job 21 with external jobid '19787108'.
[Thu Jul 22 23:59:45 2021]
Finished job 18.
51 of 196 steps (26%) done
[Fri Jul 23 00:00:25 2021]
Finished job 34.
52 of 196 steps (27%) done
[Fri Jul 23 00:01:29 2021]
Finished job 30.
53 of 196 steps (27%) done
[Fri Jul 23 00:06:14 2021]
Finished job 46.
54 of 196 steps (28%) done
[Fri Jul 23 00:06:42 2021]
Finished job 40.
55 of 196 steps (28%) done
[Fri Jul 23 00:14:17 2021]
Finished job 32.
56 of 196 steps (29%) done
[Fri Jul 23 00:14:57 2021]
Finished job 36.
57 of 196 steps (29%) done
[Fri Jul 23 00:16:39 2021]
Finished job 48.
58 of 196 steps (30%) done
[Fri Jul 23 00:18:50 2021]
Finished job 17.
59 of 196 steps (30%) done
[Fri Jul 23 00:26:38 2021]
Finished job 38.
60 of 196 steps (31%) done
[Fri Jul 23 00:33:29 2021]
Finished job 29.
61 of 196 steps (31%) done
[Fri Jul 23 00:35:31 2021]
Finished job 19.
62 of 196 steps (32%) done
[Fri Jul 23 00:37:55 2021]
Finished job 23.
63 of 196 steps (32%) done
[Fri Jul 23 00:39:57 2021]
Finished job 31.
64 of 196 steps (33%) done
[Fri Jul 23 00:45:34 2021]
Finished job 21.
65 of 196 steps (33%) done

[Fri Jul 23 00:45:34 2021]
rule get_fastq_nreads:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/raw_fastq, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_4SU_labeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_4SU_labeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_4SU_labeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_4SU_labeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_1.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_labeled_2.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_1.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/SRA_unlabeled_2.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep1_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep2_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep1_unlabeled.R1.trim.fastuniq.fastq.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep2_unlabeled.R1.trim.fastuniq.fastq.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/raw_fastq/lanes.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim/lanes.txt, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/lanes.txt
    jobid: 33
    threads: 56


for f in /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/raw_fastq /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/trim /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq;do
cd $f
bash /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/get_lanes.sh
done

Submitted job 33 with external jobid '19789443'.
[Fri Jul 23 01:00:45 2021]
Finished job 154.
66 of 196 steps (34%) done
[Fri Jul 23 01:22:48 2021]
Finished job 33.
67 of 196 steps (34%) done
[Fri Jul 23 01:23:34 2021]
Finished job 152.
68 of 196 steps (35%) done
[Fri Jul 23 01:23:46 2021]
Finished job 148.
69 of 196 steps (35%) done
[Fri Jul 23 01:29:35 2021]
Finished job 57.
70 of 196 steps (36%) done

[Fri Jul 23 01:29:35 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_unlabeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.toSNPcalling.bam.flagstat
    jobid: 170
    wildcards: sample=WT4_unlabeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam -o /dev/shm/WT4_unlabeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.toSNPcalling.bam /dev/shm/WT4_unlabeled.plus.bam && rm -f /dev/shm/WT4_unlabeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam -o /dev/shm/WT4_unlabeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.toSNPcalling.bam /dev/shm/WT4_unlabeled.minus.bam && rm -f /dev/shm/WT4_unlabeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.toSNPcalling.bam.flagstat

Submitted job 170 with external jobid '19791442'.
[Fri Jul 23 01:54:00 2021]
Finished job 55.
71 of 196 steps (36%) done

[Fri Jul 23 01:54:00 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_unlabeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.toSNPcalling.bam.flagstat
    jobid: 168
    wildcards: sample=WT3_unlabeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam -o /dev/shm/WT3_unlabeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.toSNPcalling.bam /dev/shm/WT3_unlabeled.plus.bam && rm -f /dev/shm/WT3_unlabeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam -o /dev/shm/WT3_unlabeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.toSNPcalling.bam /dev/shm/WT3_unlabeled.minus.bam && rm -f /dev/shm/WT3_unlabeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.toSNPcalling.bam.flagstat

Submitted job 168 with external jobid '19792850'.
[Fri Jul 23 01:56:37 2021]
Finished job 53.
72 of 196 steps (37%) done

[Fri Jul 23 01:56:37 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_unlabeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.toSNPcalling.bam.flagstat
    jobid: 166
    wildcards: sample=KO8_unlabeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam -o /dev/shm/KO8_unlabeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.toSNPcalling.bam /dev/shm/KO8_unlabeled.plus.bam && rm -f /dev/shm/KO8_unlabeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam -o /dev/shm/KO8_unlabeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.toSNPcalling.bam /dev/shm/KO8_unlabeled.minus.bam && rm -f /dev/shm/KO8_unlabeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.toSNPcalling.bam.flagstat

Submitted job 166 with external jobid '19792995'.
[Fri Jul 23 01:57:25 2021]
Finished job 51.
73 of 196 steps (37%) done

[Fri Jul 23 01:57:25 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_unlabeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.toSNPcalling.bam.flagstat
    jobid: 164
    wildcards: sample=KO1_unlabeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam -o /dev/shm/KO1_unlabeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.toSNPcalling.bam /dev/shm/KO1_unlabeled.plus.bam && rm -f /dev/shm/KO1_unlabeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam -o /dev/shm/KO1_unlabeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.toSNPcalling.bam /dev/shm/KO1_unlabeled.minus.bam && rm -f /dev/shm/KO1_unlabeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.toSNPcalling.bam.flagstat

Submitted job 164 with external jobid '19793035'.
[Fri Jul 23 02:06:37 2021]
Finished job 170.
74 of 196 steps (38%) done

[Fri Jul 23 02:06:37 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.vcf.gz
    jobid: 73
    wildcards: sample=WT4_unlabeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/WT4_unlabeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/WT4_unlabeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/WT4_unlabeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/WT4_unlabeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.vcf.gz

Submitted job 73 with external jobid '19793409'.
[Fri Jul 23 02:11:13 2021]
Finished job 150.
75 of 196 steps (38%) done
[Fri Jul 23 02:26:14 2021]
Finished job 168.
76 of 196 steps (39%) done

[Fri Jul 23 02:26:14 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.vcf.gz
    jobid: 71
    wildcards: sample=WT3_unlabeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/WT3_unlabeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/WT3_unlabeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/WT3_unlabeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/WT3_unlabeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.vcf.gz

Submitted job 71 with external jobid '19794267'.
[Fri Jul 23 02:31:03 2021]
Finished job 166.
77 of 196 steps (39%) done

[Fri Jul 23 02:31:03 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.vcf.gz
    jobid: 69
    wildcards: sample=KO8_unlabeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/KO8_unlabeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/KO8_unlabeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/KO8_unlabeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/KO8_unlabeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.vcf.gz

Submitted job 69 with external jobid '19794523'.
[Fri Jul 23 02:33:39 2021]
Finished job 164.
78 of 196 steps (40%) done

[Fri Jul 23 02:33:39 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.vcf.gz
    jobid: 67
    wildcards: sample=KO1_unlabeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/KO1_unlabeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/KO1_unlabeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/KO1_unlabeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/KO1_unlabeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.vcf.gz

Submitted job 67 with external jobid '19794888'.
[Fri Jul 23 02:36:27 2021]
Finished job 50.
79 of 196 steps (40%) done

[Fri Jul 23 02:36:27 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_4SU_labeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.toSNPcalling.bam.flagstat
    jobid: 163
    wildcards: sample=KO1_4SU_labeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam -o /dev/shm/KO1_4SU_labeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_4SU_labeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.toSNPcalling.bam /dev/shm/KO1_4SU_labeled.plus.bam && rm -f /dev/shm/KO1_4SU_labeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam -o /dev/shm/KO1_4SU_labeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_4SU_labeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.toSNPcalling.bam /dev/shm/KO1_4SU_labeled.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.toSNPcalling.bam.flagstat

Submitted job 163 with external jobid '19795024'.
[Fri Jul 23 02:37:51 2021]
Finished job 52.
80 of 196 steps (41%) done

[Fri Jul 23 02:37:51 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_4SU_labeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.toSNPcalling.bam.flagstat
    jobid: 165
    wildcards: sample=KO8_4SU_labeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam -o /dev/shm/KO8_4SU_labeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_4SU_labeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.toSNPcalling.bam /dev/shm/KO8_4SU_labeled.plus.bam && rm -f /dev/shm/KO8_4SU_labeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam -o /dev/shm/KO8_4SU_labeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO8_4SU_labeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.toSNPcalling.bam /dev/shm/KO8_4SU_labeled.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.toSNPcalling.bam.flagstat

Submitted job 165 with external jobid '19795338'.
[Fri Jul 23 02:39:52 2021]
Finished job 54.
81 of 196 steps (41%) done

[Fri Jul 23 02:39:52 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_4SU_labeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.toSNPcalling.bam.flagstat
    jobid: 167
    wildcards: sample=WT3_4SU_labeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam -o /dev/shm/WT3_4SU_labeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_4SU_labeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.toSNPcalling.bam /dev/shm/WT3_4SU_labeled.plus.bam && rm -f /dev/shm/WT3_4SU_labeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam -o /dev/shm/WT3_4SU_labeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT3_4SU_labeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.toSNPcalling.bam /dev/shm/WT3_4SU_labeled.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.toSNPcalling.bam.flagstat

Submitted job 167 with external jobid '19795507'.
[Fri Jul 23 02:51:04 2021]
Finished job 63.
82 of 196 steps (42%) done

[Fri Jul 23 02:51:04 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep2_unlabeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.toSNPcalling.bam.flagstat
    jobid: 176
    wildcards: sample=KO1_techrep2_unlabeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam -o /dev/shm/KO1_techrep2_unlabeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep2_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.toSNPcalling.bam /dev/shm/KO1_techrep2_unlabeled.plus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam -o /dev/shm/KO1_techrep2_unlabeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep2_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.toSNPcalling.bam /dev/shm/KO1_techrep2_unlabeled.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.toSNPcalling.bam.flagstat

Submitted job 176 with external jobid '19796121'.
[Fri Jul 23 02:51:28 2021]
Finished job 147.
83 of 196 steps (42%) done
[Fri Jul 23 03:02:52 2021]
Finished job 162.
84 of 196 steps (43%) done
[Fri Jul 23 03:03:59 2021]
Finished job 167.
85 of 196 steps (43%) done

[Fri Jul 23 03:03:59 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.vcf.gz
    jobid: 70
    wildcards: sample=WT3_4SU_labeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/WT3_4SU_labeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/WT3_4SU_labeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/WT3_4SU_labeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/WT3_4SU_labeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.vcf.gz

Submitted job 70 with external jobid '19796710'.
[Fri Jul 23 03:11:08 2021]
Finished job 165.
86 of 196 steps (44%) done

[Fri Jul 23 03:11:08 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.vcf.gz
    jobid: 68
    wildcards: sample=KO8_4SU_labeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/KO8_4SU_labeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/KO8_4SU_labeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/KO8_4SU_labeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/KO8_4SU_labeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.vcf.gz

Submitted job 68 with external jobid '19797041'.
[Fri Jul 23 03:13:52 2021]
Finished job 160.
87 of 196 steps (44%) done
[Fri Jul 23 03:28:22 2021]
Finished job 56.
88 of 196 steps (45%) done

[Fri Jul 23 03:28:23 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_4SU_labeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.toSNPcalling.bam.flagstat
    jobid: 169
    wildcards: sample=WT4_4SU_labeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam -o /dev/shm/WT4_4SU_labeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_4SU_labeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.toSNPcalling.bam /dev/shm/WT4_4SU_labeled.plus.bam && rm -f /dev/shm/WT4_4SU_labeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam -o /dev/shm/WT4_4SU_labeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_4SU_labeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.toSNPcalling.bam /dev/shm/WT4_4SU_labeled.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.toSNPcalling.bam.flagstat

Submitted job 169 with external jobid '19797660'.
[Fri Jul 23 03:30:03 2021]
Finished job 163.
89 of 196 steps (45%) done

[Fri Jul 23 03:30:03 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.vcf.gz
    jobid: 66
    wildcards: sample=KO1_4SU_labeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/KO1_4SU_labeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/KO1_4SU_labeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/KO1_4SU_labeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/KO1_4SU_labeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.vcf.gz

Submitted job 66 with external jobid '19797730'.
[Fri Jul 23 03:32:15 2021]
Finished job 176.
90 of 196 steps (46%) done

[Fri Jul 23 03:32:15 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.vcf.gz
    jobid: 79
    wildcards: sample=KO1_techrep2_unlabeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/KO1_techrep2_unlabeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/KO1_techrep2_unlabeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/KO1_techrep2_unlabeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/KO1_techrep2_unlabeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.vcf.gz

Submitted job 79 with external jobid '19797807'.
[Fri Jul 23 03:37:33 2021]
Finished job 64.
91 of 196 steps (46%) done

[Fri Jul 23 03:37:33 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep1_unlabeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.toSNPcalling.bam.flagstat
    jobid: 177
    wildcards: sample=WT4_techrep1_unlabeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam -o /dev/shm/WT4_techrep1_unlabeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep1_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.toSNPcalling.bam /dev/shm/WT4_techrep1_unlabeled.plus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam -o /dev/shm/WT4_techrep1_unlabeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep1_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.toSNPcalling.bam /dev/shm/WT4_techrep1_unlabeled.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.toSNPcalling.bam.flagstat

Submitted job 177 with external jobid '19798007'.
[Fri Jul 23 03:39:23 2021]
Finished job 161.
92 of 196 steps (47%) done
[Fri Jul 23 03:52:03 2021]
Finished job 71.
93 of 196 steps (47%) done

[Fri Jul 23 03:52:03 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat
    jobid: 87
    wildcards: sample=WT3_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam -o /dev/shm/WT3_unlabeled.mutated.plus.bam --readids /dev/shm/WT3_unlabeled.plus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam -o /dev/shm/WT3_unlabeled.mutated.minus.bam --readids /dev/shm/WT3_unlabeled.minus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.bam && rm -f /dev/shm/WT3_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat

Submitted job 87 with external jobid '19798538'.
[Fri Jul 23 03:52:37 2021]
Error in rule split_bam_by_mutation:
    jobid: 87
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam -o /dev/shm/WT3_unlabeled.mutated.plus.bam --readids /dev/shm/WT3_unlabeled.plus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam -o /dev/shm/WT3_unlabeled.mutated.minus.bam --readids /dev/shm/WT3_unlabeled.minus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.bam && rm -f /dev/shm/WT3_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19798538

Error executing rule split_bam_by_mutation on cluster (jobid: 87, external: 19798538, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.87.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 87.

[Fri Jul 23 03:52:37 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat
    jobid: 87
    wildcards: sample=WT3_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam -o /dev/shm/WT3_unlabeled.mutated.plus.bam --readids /dev/shm/WT3_unlabeled.plus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam -o /dev/shm/WT3_unlabeled.mutated.minus.bam --readids /dev/shm/WT3_unlabeled.minus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.bam && rm -f /dev/shm/WT3_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat

Submitted job 87 with external jobid '19798559'.
[Fri Jul 23 03:53:09 2021]
Finished job 153.
94 of 196 steps (48%) done
[Fri Jul 23 03:53:54 2021]
Finished job 149.
95 of 196 steps (48%) done
[Fri Jul 23 03:53:54 2021]
Error in rule split_bam_by_mutation:
    jobid: 87
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam -o /dev/shm/WT3_unlabeled.mutated.plus.bam --readids /dev/shm/WT3_unlabeled.plus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam -o /dev/shm/WT3_unlabeled.mutated.minus.bam --readids /dev/shm/WT3_unlabeled.minus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.bam && rm -f /dev/shm/WT3_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19798559

Error executing rule split_bam_by_mutation on cluster (jobid: 87, external: 19798559, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.87.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 87.

[Fri Jul 23 03:53:54 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat
    jobid: 87
    wildcards: sample=WT3_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam -o /dev/shm/WT3_unlabeled.mutated.plus.bam --readids /dev/shm/WT3_unlabeled.plus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam -o /dev/shm/WT3_unlabeled.mutated.minus.bam --readids /dev/shm/WT3_unlabeled.minus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.bam && rm -f /dev/shm/WT3_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat

Submitted job 87 with external jobid '19798618'.
[Fri Jul 23 03:54:17 2021]
Error in rule split_bam_by_mutation:
    jobid: 87
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.plus.bam -o /dev/shm/WT3_unlabeled.mutated.plus.bam --readids /dev/shm/WT3_unlabeled.plus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_unlabeled.minus.bam -o /dev/shm/WT3_unlabeled.mutated.minus.bam --readids /dev/shm/WT3_unlabeled.minus.readids -o2 /dev/shm/WT3_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.mutated.plus.bam /dev/shm/WT3_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam /dev/shm/WT3_unlabeled.mutated.bam && rm -f /dev/shm/WT3_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.plus.bam /dev/shm/WT3_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam /dev/shm/WT3_unlabeled.unmutated.bam && rm -f /dev/shm/WT3_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19798618

Error executing rule split_bam_by_mutation on cluster (jobid: 87, external: 19798618, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.87.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Fri Jul 23 03:59:24 2021]
Finished job 67.
96 of 196 steps (49%) done

[Fri Jul 23 03:59:24 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat
    jobid: 83
    wildcards: sample=KO1_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam -o /dev/shm/KO1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_unlabeled.plus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam -o /dev/shm/KO1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_unlabeled.minus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat

Submitted job 83 with external jobid '19798852'.
[Fri Jul 23 04:01:59 2021]
Error in rule split_bam_by_mutation:
    jobid: 83
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam -o /dev/shm/KO1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_unlabeled.plus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam -o /dev/shm/KO1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_unlabeled.minus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19798852

Error executing rule split_bam_by_mutation on cluster (jobid: 83, external: 19798852, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.83.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 83.

[Fri Jul 23 04:01:59 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat
    jobid: 83
    wildcards: sample=KO1_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam -o /dev/shm/KO1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_unlabeled.plus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam -o /dev/shm/KO1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_unlabeled.minus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat

Submitted job 83 with external jobid '19798981'.
[Fri Jul 23 04:03:38 2021]
Error in rule split_bam_by_mutation:
    jobid: 83
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam -o /dev/shm/KO1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_unlabeled.plus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam -o /dev/shm/KO1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_unlabeled.minus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19798981

Error executing rule split_bam_by_mutation on cluster (jobid: 83, external: 19798981, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.83.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 83.

[Fri Jul 23 04:03:38 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat
    jobid: 83
    wildcards: sample=KO1_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam -o /dev/shm/KO1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_unlabeled.plus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam -o /dev/shm/KO1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_unlabeled.minus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat

Submitted job 83 with external jobid '19799057'.
[Fri Jul 23 04:04:00 2021]
Error in rule split_bam_by_mutation:
    jobid: 83
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.plus.bam -o /dev/shm/KO1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_unlabeled.plus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_unlabeled.minus.bam -o /dev/shm/KO1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_unlabeled.minus.readids -o2 /dev/shm/KO1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.mutated.plus.bam /dev/shm/KO1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam /dev/shm/KO1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.plus.bam /dev/shm/KO1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam /dev/shm/KO1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19799057

Error executing rule split_bam_by_mutation on cluster (jobid: 83, external: 19799057, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.83.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Fri Jul 23 04:04:43 2021]
Finished job 69.
97 of 196 steps (49%) done

[Fri Jul 23 04:04:43 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat
    jobid: 85
    wildcards: sample=KO8_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam -o /dev/shm/KO8_unlabeled.mutated.plus.bam --readids /dev/shm/KO8_unlabeled.plus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam -o /dev/shm/KO8_unlabeled.mutated.minus.bam --readids /dev/shm/KO8_unlabeled.minus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.bam && rm -f /dev/shm/KO8_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat

Submitted job 85 with external jobid '19799093'.
[Fri Jul 23 04:04:55 2021]
Error in rule split_bam_by_mutation:
    jobid: 85
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam -o /dev/shm/KO8_unlabeled.mutated.plus.bam --readids /dev/shm/KO8_unlabeled.plus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam -o /dev/shm/KO8_unlabeled.mutated.minus.bam --readids /dev/shm/KO8_unlabeled.minus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.bam && rm -f /dev/shm/KO8_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19799093

Error executing rule split_bam_by_mutation on cluster (jobid: 85, external: 19799093, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.85.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 85.

[Fri Jul 23 04:04:55 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat
    jobid: 85
    wildcards: sample=KO8_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam -o /dev/shm/KO8_unlabeled.mutated.plus.bam --readids /dev/shm/KO8_unlabeled.plus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam -o /dev/shm/KO8_unlabeled.mutated.minus.bam --readids /dev/shm/KO8_unlabeled.minus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.bam && rm -f /dev/shm/KO8_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat

Submitted job 85 with external jobid '19799109'.
[Fri Jul 23 04:05:40 2021]
Error in rule split_bam_by_mutation:
    jobid: 85
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam -o /dev/shm/KO8_unlabeled.mutated.plus.bam --readids /dev/shm/KO8_unlabeled.plus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam -o /dev/shm/KO8_unlabeled.mutated.minus.bam --readids /dev/shm/KO8_unlabeled.minus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.bam && rm -f /dev/shm/KO8_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19799109

Error executing rule split_bam_by_mutation on cluster (jobid: 85, external: 19799109, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.85.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 85.

[Fri Jul 23 04:05:40 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat
    jobid: 85
    wildcards: sample=KO8_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam -o /dev/shm/KO8_unlabeled.mutated.plus.bam --readids /dev/shm/KO8_unlabeled.plus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam -o /dev/shm/KO8_unlabeled.mutated.minus.bam --readids /dev/shm/KO8_unlabeled.minus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.bam && rm -f /dev/shm/KO8_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat

Submitted job 85 with external jobid '19799150'.
[Fri Jul 23 04:06:35 2021]
Error in rule split_bam_by_mutation:
    jobid: 85
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.plus.bam -o /dev/shm/KO8_unlabeled.mutated.plus.bam --readids /dev/shm/KO8_unlabeled.plus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_unlabeled.minus.bam -o /dev/shm/KO8_unlabeled.mutated.minus.bam --readids /dev/shm/KO8_unlabeled.minus.readids -o2 /dev/shm/KO8_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.mutated.plus.bam /dev/shm/KO8_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam /dev/shm/KO8_unlabeled.mutated.bam && rm -f /dev/shm/KO8_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.plus.bam /dev/shm/KO8_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam /dev/shm/KO8_unlabeled.unmutated.bam && rm -f /dev/shm/KO8_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19799150

Error executing rule split_bam_by_mutation on cluster (jobid: 85, external: 19799150, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.85.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Fri Jul 23 04:09:30 2021]
Finished job 73.
98 of 196 steps (50%) done

[Fri Jul 23 04:09:30 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat
    jobid: 89
    wildcards: sample=WT4_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam -o /dev/shm/WT4_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_unlabeled.plus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam -o /dev/shm/WT4_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_unlabeled.minus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.bam && rm -f /dev/shm/WT4_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat

Submitted job 89 with external jobid '19799289'.
[Fri Jul 23 04:09:41 2021]
Finished job 65.
99 of 196 steps (51%) done

[Fri Jul 23 04:09:41 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep2_unlabeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.toSNPcalling.bam.flagstat
    jobid: 178
    wildcards: sample=WT4_techrep2_unlabeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam -o /dev/shm/WT4_techrep2_unlabeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep2_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.toSNPcalling.bam /dev/shm/WT4_techrep2_unlabeled.plus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam -o /dev/shm/WT4_techrep2_unlabeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/WT4_techrep2_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.toSNPcalling.bam /dev/shm/WT4_techrep2_unlabeled.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.toSNPcalling.bam.flagstat

Submitted job 178 with external jobid '19799293'.
[Fri Jul 23 04:10:58 2021]
Error in rule split_bam_by_mutation:
    jobid: 89
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam -o /dev/shm/WT4_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_unlabeled.plus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam -o /dev/shm/WT4_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_unlabeled.minus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.bam && rm -f /dev/shm/WT4_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19799289

Error executing rule split_bam_by_mutation on cluster (jobid: 89, external: 19799289, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.89.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 89.

[Fri Jul 23 04:10:58 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat
    jobid: 89
    wildcards: sample=WT4_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam -o /dev/shm/WT4_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_unlabeled.plus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam -o /dev/shm/WT4_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_unlabeled.minus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.bam && rm -f /dev/shm/WT4_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat

Submitted job 89 with external jobid '19799353'.
[Fri Jul 23 04:11:21 2021]
Error in rule split_bam_by_mutation:
    jobid: 89
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam -o /dev/shm/WT4_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_unlabeled.plus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam -o /dev/shm/WT4_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_unlabeled.minus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.bam && rm -f /dev/shm/WT4_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19799353

Error executing rule split_bam_by_mutation on cluster (jobid: 89, external: 19799353, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.89.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 89.

[Fri Jul 23 04:11:21 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat
    jobid: 89
    wildcards: sample=WT4_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam -o /dev/shm/WT4_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_unlabeled.plus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam -o /dev/shm/WT4_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_unlabeled.minus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.bam && rm -f /dev/shm/WT4_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat

Submitted job 89 with external jobid '19799374'.
[Fri Jul 23 04:12:38 2021]
Error in rule split_bam_by_mutation:
    jobid: 89
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.plus.bam -o /dev/shm/WT4_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_unlabeled.plus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_unlabeled.minus.bam -o /dev/shm/WT4_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_unlabeled.minus.readids -o2 /dev/shm/WT4_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.mutated.plus.bam /dev/shm/WT4_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam /dev/shm/WT4_unlabeled.mutated.bam && rm -f /dev/shm/WT4_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.plus.bam /dev/shm/WT4_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam /dev/shm/WT4_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19799374

Error executing rule split_bam_by_mutation on cluster (jobid: 89, external: 19799374, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.89.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Fri Jul 23 04:15:56 2021]
Finished job 151.
100 of 196 steps (51%) done
[Fri Jul 23 04:18:57 2021]
Finished job 169.
101 of 196 steps (52%) done

[Fri Jul 23 04:18:57 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.vcf.gz
    jobid: 72
    wildcards: sample=WT4_4SU_labeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/WT4_4SU_labeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/WT4_4SU_labeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/WT4_4SU_labeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/WT4_4SU_labeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.vcf.gz

Submitted job 72 with external jobid '19799668'.
[Fri Jul 23 04:20:37 2021]
Finished job 62.
102 of 196 steps (52%) done

[Fri Jul 23 04:20:37 2021]
rule create_toSNPcalling_BAM:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep1_unlabeled.fastuniq.readids
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.toSNPcalling.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.toSNPcalling.bam.flagstat
    jobid: 175
    wildcards: sample=KO1_techrep1_unlabeled
    threads: 4


python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam -o /dev/shm/KO1_techrep1_unlabeled.plus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep1_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.toSNPcalling.bam /dev/shm/KO1_techrep1_unlabeled.plus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.plus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.toSNPcalling.bam.flagstat
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam -o /dev/shm/KO1_techrep1_unlabeled.minus.bam --readids /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/fastuniq/KO1_techrep1_unlabeled.fastuniq.readids
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.toSNPcalling.bam /dev/shm/KO1_techrep1_unlabeled.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.minus.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.toSNPcalling.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.toSNPcalling.bam.flagstat

Submitted job 175 with external jobid '19799743'.
[Fri Jul 23 04:22:37 2021]
Finished job 177.
103 of 196 steps (53%) done

[Fri Jul 23 04:22:37 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.vcf.gz
    jobid: 80
    wildcards: sample=WT4_techrep1_unlabeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/WT4_techrep1_unlabeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/WT4_techrep1_unlabeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/WT4_techrep1_unlabeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/WT4_techrep1_unlabeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.vcf.gz

Submitted job 80 with external jobid '19799798'.
[Fri Jul 23 04:38:08 2021]
Finished job 70.
104 of 196 steps (53%) done

[Fri Jul 23 04:38:08 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat
    jobid: 86
    wildcards: sample=WT3_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam -o /dev/shm/WT3_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT3_4SU_labeled.plus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam -o /dev/shm/WT3_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT3_4SU_labeled.minus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat

Submitted job 86 with external jobid '19800440'.
[Fri Jul 23 04:38:48 2021]
Error in rule split_bam_by_mutation:
    jobid: 86
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam -o /dev/shm/WT3_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT3_4SU_labeled.plus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam -o /dev/shm/WT3_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT3_4SU_labeled.minus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19800440

Error executing rule split_bam_by_mutation on cluster (jobid: 86, external: 19800440, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.86.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 86.

[Fri Jul 23 04:38:48 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat
    jobid: 86
    wildcards: sample=WT3_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam -o /dev/shm/WT3_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT3_4SU_labeled.plus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam -o /dev/shm/WT3_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT3_4SU_labeled.minus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat

Submitted job 86 with external jobid '19800475'.
[Fri Jul 23 04:39:28 2021]
Error in rule split_bam_by_mutation:
    jobid: 86
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam -o /dev/shm/WT3_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT3_4SU_labeled.plus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam -o /dev/shm/WT3_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT3_4SU_labeled.minus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19800475

Error executing rule split_bam_by_mutation on cluster (jobid: 86, external: 19800475, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.86.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 86.

[Fri Jul 23 04:39:29 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat
    jobid: 86
    wildcards: sample=WT3_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam -o /dev/shm/WT3_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT3_4SU_labeled.plus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam -o /dev/shm/WT3_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT3_4SU_labeled.minus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat

Submitted job 86 with external jobid '19800493'.
[Fri Jul 23 04:40:49 2021]
Error in rule split_bam_by_mutation:
    jobid: 86
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT3_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT3_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT3_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.plus.bam -o /dev/shm/WT3_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT3_4SU_labeled.plus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT3_4SU_labeled.minus.bam -o /dev/shm/WT3_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT3_4SU_labeled.minus.readids -o2 /dev/shm/WT3_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.plus.bam /dev/shm/WT3_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam /dev/shm/WT3_4SU_labeled.mutated.bam && rm -f /dev/shm/WT3_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.plus.bam /dev/shm/WT3_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam /dev/shm/WT3_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT3_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19800493

Error executing rule split_bam_by_mutation on cluster (jobid: 86, external: 19800493, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.86.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Fri Jul 23 04:47:49 2021]
Finished job 159.
105 of 196 steps (54%) done
[Fri Jul 23 04:58:50 2021]
Finished job 68.
106 of 196 steps (54%) done

[Fri Jul 23 04:58:50 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat
    jobid: 84
    wildcards: sample=KO8_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam -o /dev/shm/KO8_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO8_4SU_labeled.plus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam -o /dev/shm/KO8_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO8_4SU_labeled.minus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat

Submitted job 84 with external jobid '19801315'.
[Fri Jul 23 04:59:10 2021]
Finished job 178.
107 of 196 steps (55%) done

[Fri Jul 23 04:59:10 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.vcf.gz
    jobid: 81
    wildcards: sample=WT4_techrep2_unlabeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/WT4_techrep2_unlabeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/WT4_techrep2_unlabeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/WT4_techrep2_unlabeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/WT4_techrep2_unlabeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.vcf.gz

Submitted job 81 with external jobid '19801333'.
[Fri Jul 23 04:59:50 2021]
Error in rule split_bam_by_mutation:
    jobid: 84
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam -o /dev/shm/KO8_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO8_4SU_labeled.plus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam -o /dev/shm/KO8_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO8_4SU_labeled.minus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19801315

Error executing rule split_bam_by_mutation on cluster (jobid: 84, external: 19801315, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.84.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 84.

[Fri Jul 23 04:59:50 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat
    jobid: 84
    wildcards: sample=KO8_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam -o /dev/shm/KO8_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO8_4SU_labeled.plus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam -o /dev/shm/KO8_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO8_4SU_labeled.minus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat

Submitted job 84 with external jobid '19801365'.
[Fri Jul 23 05:01:20 2021]
Error in rule split_bam_by_mutation:
    jobid: 84
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam -o /dev/shm/KO8_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO8_4SU_labeled.plus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam -o /dev/shm/KO8_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO8_4SU_labeled.minus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19801365

Error executing rule split_bam_by_mutation on cluster (jobid: 84, external: 19801365, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.84.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 84.

[Fri Jul 23 05:01:20 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat
    jobid: 84
    wildcards: sample=KO8_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam -o /dev/shm/KO8_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO8_4SU_labeled.plus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam -o /dev/shm/KO8_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO8_4SU_labeled.minus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat

Submitted job 84 with external jobid '19801453'.
[Fri Jul 23 05:03:40 2021]
Error in rule split_bam_by_mutation:
    jobid: 84
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO8_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO8_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO8_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.plus.bam -o /dev/shm/KO8_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO8_4SU_labeled.plus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO8_4SU_labeled.minus.bam -o /dev/shm/KO8_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO8_4SU_labeled.minus.readids -o2 /dev/shm/KO8_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.plus.bam /dev/shm/KO8_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam /dev/shm/KO8_4SU_labeled.mutated.bam && rm -f /dev/shm/KO8_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.plus.bam /dev/shm/KO8_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam /dev/shm/KO8_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO8_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19801453

Error executing rule split_bam_by_mutation on cluster (jobid: 84, external: 19801453, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.84.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Fri Jul 23 05:23:22 2021]
Finished job 175.
108 of 196 steps (55%) done

[Fri Jul 23 05:23:22 2021]
rule call_mutations:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.toSNPcalling.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.toSNPcalling.bam
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.vcf.gz
    jobid: 78
    wildcards: sample=KO1_techrep1_unlabeled
    threads: 56


# call mutations with minimum 3 read-support
# plus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.toSNPcalling.bam | bcftools view -i '(REF=="T" & ALT="C")' --threads 56 - > /dev/shm/KO1_techrep1_unlabeled.TtoC.bcf
bcftools sort -T /dev/shm /dev/shm/KO1_techrep1_unlabeled.TtoC.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz
# minus strand
bcftools mpileup -f /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa -a AD,ADF,ADR /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.toSNPcalling.bam | bcftools view -i '(REF=="A" & ALT="G")' --threads 56 - > /dev/shm/KO1_techrep1_unlabeled.AtoG.bcf
bcftools sort -T /dev/shm /dev/shm/KO1_techrep1_unlabeled.AtoG.bcf | bgzip > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz
# merge mutations
bcftools merge --force-samples -O z -o /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz
tabix -p vcf /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.vcf.gz

Submitted job 78 with external jobid '19802478'.
[Fri Jul 23 05:27:52 2021]
Finished job 66.
109 of 196 steps (56%) done

[Fri Jul 23 05:27:52 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat
    jobid: 82
    wildcards: sample=KO1_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam -o /dev/shm/KO1_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO1_4SU_labeled.plus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam -o /dev/shm/KO1_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO1_4SU_labeled.minus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat

Submitted job 82 with external jobid '19802839'.
[Fri Jul 23 05:30:32 2021]
Error in rule split_bam_by_mutation:
    jobid: 82
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam -o /dev/shm/KO1_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO1_4SU_labeled.plus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam -o /dev/shm/KO1_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO1_4SU_labeled.minus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19802839

Error executing rule split_bam_by_mutation on cluster (jobid: 82, external: 19802839, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.82.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 82.

[Fri Jul 23 05:30:32 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat
    jobid: 82
    wildcards: sample=KO1_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam -o /dev/shm/KO1_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO1_4SU_labeled.plus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam -o /dev/shm/KO1_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO1_4SU_labeled.minus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat

Submitted job 82 with external jobid '19802955'.
[Fri Jul 23 05:32:22 2021]
Error in rule split_bam_by_mutation:
    jobid: 82
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam -o /dev/shm/KO1_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO1_4SU_labeled.plus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam -o /dev/shm/KO1_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO1_4SU_labeled.minus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19802955

Error executing rule split_bam_by_mutation on cluster (jobid: 82, external: 19802955, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.82.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 82.

[Fri Jul 23 05:32:22 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat
    jobid: 82
    wildcards: sample=KO1_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam -o /dev/shm/KO1_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO1_4SU_labeled.plus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam -o /dev/shm/KO1_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO1_4SU_labeled.minus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat

Submitted job 82 with external jobid '19803032'.
[Fri Jul 23 05:34:02 2021]
Error in rule split_bam_by_mutation:
    jobid: 82
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.plus.bam -o /dev/shm/KO1_4SU_labeled.mutated.plus.bam --readids /dev/shm/KO1_4SU_labeled.plus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_4SU_labeled.minus.bam -o /dev/shm/KO1_4SU_labeled.mutated.minus.bam --readids /dev/shm/KO1_4SU_labeled.minus.readids -o2 /dev/shm/KO1_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.plus.bam /dev/shm/KO1_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam /dev/shm/KO1_4SU_labeled.mutated.bam && rm -f /dev/shm/KO1_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.plus.bam /dev/shm/KO1_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam /dev/shm/KO1_4SU_labeled.unmutated.bam && rm -f /dev/shm/KO1_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19803032

Error executing rule split_bam_by_mutation on cluster (jobid: 82, external: 19803032, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.82.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Fri Jul 23 05:40:43 2021]
Finished job 79.
110 of 196 steps (56%) done

[Fri Jul 23 05:40:43 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat
    jobid: 95
    wildcards: sample=KO1_techrep2_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep2_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep2_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat

Submitted job 95 with external jobid '19803394'.
[Fri Jul 23 05:41:53 2021]
Error in rule split_bam_by_mutation:
    jobid: 95
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep2_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep2_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19803394

Error executing rule split_bam_by_mutation on cluster (jobid: 95, external: 19803394, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.95.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 95.

[Fri Jul 23 05:41:53 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat
    jobid: 95
    wildcards: sample=KO1_techrep2_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep2_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep2_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat

Submitted job 95 with external jobid '19803449'.
[Fri Jul 23 05:43:23 2021]
Error in rule split_bam_by_mutation:
    jobid: 95
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep2_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep2_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19803449

Error executing rule split_bam_by_mutation on cluster (jobid: 95, external: 19803449, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.95.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 95.

[Fri Jul 23 05:43:23 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat
    jobid: 95
    wildcards: sample=KO1_techrep2_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep2_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep2_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat

Submitted job 95 with external jobid '19803707'.
[Fri Jul 23 05:44:33 2021]
Error in rule split_bam_by_mutation:
    jobid: 95
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.plus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep2_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep2_unlabeled.minus.bam -o /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep2_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam /dev/shm/KO1_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam /dev/shm/KO1_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19803707

Error executing rule split_bam_by_mutation on cluster (jobid: 95, external: 19803707, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.95.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Fri Jul 23 06:10:55 2021]
Finished job 80.
111 of 196 steps (57%) done

[Fri Jul 23 06:10:55 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat
    jobid: 96
    wildcards: sample=WT4_techrep1_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep1_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep1_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat

Submitted job 96 with external jobid '19805126'.
[Fri Jul 23 06:12:05 2021]
Error in rule split_bam_by_mutation:
    jobid: 96
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep1_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep1_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19805126

Error executing rule split_bam_by_mutation on cluster (jobid: 96, external: 19805126, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.96.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 96.

[Fri Jul 23 06:12:05 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat
    jobid: 96
    wildcards: sample=WT4_techrep1_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep1_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep1_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat

Submitted job 96 with external jobid '19805182'.
[Fri Jul 23 06:17:45 2021]
Error in rule split_bam_by_mutation:
    jobid: 96
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep1_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep1_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19805182

Error executing rule split_bam_by_mutation on cluster (jobid: 96, external: 19805182, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.96.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 96.

[Fri Jul 23 06:17:45 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat
    jobid: 96
    wildcards: sample=WT4_techrep1_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep1_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep1_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat

Submitted job 96 with external jobid '19805441'.
[Fri Jul 23 06:19:56 2021]
Error in rule split_bam_by_mutation:
    jobid: 96
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.plus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep1_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep1_unlabeled.minus.bam -o /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep1_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam /dev/shm/WT4_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam /dev/shm/WT4_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19805441

Error executing rule split_bam_by_mutation on cluster (jobid: 96, external: 19805441, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.96.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Fri Jul 23 06:42:57 2021]
Finished job 81.
112 of 196 steps (57%) done

[Fri Jul 23 06:42:57 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat
    jobid: 97
    wildcards: sample=WT4_techrep2_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep2_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep2_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat

Submitted job 97 with external jobid '19806559'.
[Fri Jul 23 06:43:27 2021]
Error in rule split_bam_by_mutation:
    jobid: 97
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep2_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep2_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19806559

Error executing rule split_bam_by_mutation on cluster (jobid: 97, external: 19806559, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.97.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 97.

[Fri Jul 23 06:43:27 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat
    jobid: 97
    wildcards: sample=WT4_techrep2_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep2_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep2_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat

Submitted job 97 with external jobid '19806576'.
[Fri Jul 23 06:48:47 2021]
Error in rule split_bam_by_mutation:
    jobid: 97
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep2_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep2_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19806576

Error executing rule split_bam_by_mutation on cluster (jobid: 97, external: 19806576, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.97.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 97.

[Fri Jul 23 06:48:48 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat
    jobid: 97
    wildcards: sample=WT4_techrep2_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep2_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep2_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat

Submitted job 97 with external jobid '19806819'.
[Fri Jul 23 06:50:18 2021]
Error in rule split_bam_by_mutation:
    jobid: 97
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_techrep2_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_techrep2_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.plus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam --readids /dev/shm/WT4_techrep2_unlabeled.plus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_techrep2_unlabeled.minus.bam -o /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam --readids /dev/shm/WT4_techrep2_unlabeled.minus.readids -o2 /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam /dev/shm/WT4_techrep2_unlabeled.mutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.plus.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam /dev/shm/WT4_techrep2_unlabeled.unmutated.bam && rm -f /dev/shm/WT4_techrep2_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19806819

Error executing rule split_bam_by_mutation on cluster (jobid: 97, external: 19806819, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.97.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Fri Jul 23 07:16:59 2021]
Finished job 72.
113 of 196 steps (58%) done

[Fri Jul 23 07:16:59 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat
    jobid: 88
    wildcards: sample=WT4_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam -o /dev/shm/WT4_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT4_4SU_labeled.plus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam -o /dev/shm/WT4_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT4_4SU_labeled.minus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat

Submitted job 88 with external jobid '19808030'.
[Fri Jul 23 07:19:49 2021]
Error in rule split_bam_by_mutation:
    jobid: 88
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam -o /dev/shm/WT4_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT4_4SU_labeled.plus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam -o /dev/shm/WT4_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT4_4SU_labeled.minus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19808030

Error executing rule split_bam_by_mutation on cluster (jobid: 88, external: 19808030, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.88.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 88.

[Fri Jul 23 07:19:50 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat
    jobid: 88
    wildcards: sample=WT4_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam -o /dev/shm/WT4_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT4_4SU_labeled.plus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam -o /dev/shm/WT4_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT4_4SU_labeled.minus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat

Submitted job 88 with external jobid '19808142'.
[Fri Jul 23 07:23:20 2021]
Error in rule split_bam_by_mutation:
    jobid: 88
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam -o /dev/shm/WT4_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT4_4SU_labeled.plus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam -o /dev/shm/WT4_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT4_4SU_labeled.minus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19808142

Error executing rule split_bam_by_mutation on cluster (jobid: 88, external: 19808142, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.88.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 88.

[Fri Jul 23 07:23:20 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat
    jobid: 88
    wildcards: sample=WT4_4SU_labeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam -o /dev/shm/WT4_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT4_4SU_labeled.plus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam -o /dev/shm/WT4_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT4_4SU_labeled.minus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat

Submitted job 88 with external jobid '19808292'.
[Fri Jul 23 07:24:50 2021]
Error in rule split_bam_by_mutation:
    jobid: 88
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/WT4_4SU_labeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/WT4_4SU_labeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/WT4_4SU_labeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.plus.bam -o /dev/shm/WT4_4SU_labeled.mutated.plus.bam --readids /dev/shm/WT4_4SU_labeled.plus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/WT4_4SU_labeled.minus.bam -o /dev/shm/WT4_4SU_labeled.mutated.minus.bam --readids /dev/shm/WT4_4SU_labeled.minus.readids -o2 /dev/shm/WT4_4SU_labeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.plus.bam /dev/shm/WT4_4SU_labeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam /dev/shm/WT4_4SU_labeled.mutated.bam && rm -f /dev/shm/WT4_4SU_labeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.plus.bam /dev/shm/WT4_4SU_labeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam /dev/shm/WT4_4SU_labeled.unmutated.bam && rm -f /dev/shm/WT4_4SU_labeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19808292

Error executing rule split_bam_by_mutation on cluster (jobid: 88, external: 19808292, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.88.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
[Fri Jul 23 08:09:13 2021]
Finished job 78.
114 of 196 steps (58%) done

[Fri Jul 23 08:09:13 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat
    jobid: 94
    wildcards: sample=KO1_techrep1_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep1_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep1_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat

Submitted job 94 with external jobid '19812406'.
[Fri Jul 23 08:20:33 2021]
Error in rule split_bam_by_mutation:
    jobid: 94
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep1_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep1_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19812406

Error executing rule split_bam_by_mutation on cluster (jobid: 94, external: 19812406, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.94.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 94.

[Fri Jul 23 08:20:33 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat
    jobid: 94
    wildcards: sample=KO1_techrep1_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep1_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep1_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat

Submitted job 94 with external jobid '19812900'.
[Fri Jul 23 08:26:54 2021]
Error in rule split_bam_by_mutation:
    jobid: 94
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep1_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep1_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19812900

Error executing rule split_bam_by_mutation on cluster (jobid: 94, external: 19812900, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.94.sh). For error details see the cluster log and the log files of the involved rule(s).
Trying to restart job 94.

[Fri Jul 23 08:26:54 2021]
rule split_bam_by_mutation:
    input: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat
    jobid: 94
    wildcards: sample=KO1_techrep1_unlabeled
    threads: 4


# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep1_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep1_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat

Submitted job 94 with external jobid '19813301'.
[Fri Jul 23 08:28:34 2021]
Error in rule split_bam_by_mutation:
    jobid: 94
    output: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat, /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat
    shell:
        
# using sam2tsv from jvarkit --> https://lindenb.github.io/jvarkit/Sam2Tsv.html

plusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.plus.vcf.gz > /dev/shm/${plusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${plusvcf%.*} "T" "C" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.plus.readids

minusvcf=$(basename /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz)
zcat /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/vcf/KO1_techrep1_unlabeled.minus.vcf.gz > /dev/shm/${minusvcf%.*}
java -Xmx200g -jar /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/resources/sam2tsv.jar  --reference /data/RBL_NCI/Wolin/mESC_slam_analysis/resources/mm10/mm10.plus_rDNA_plus_5S.id90_masked.fa  --skip-N  /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam | python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/tsv2readids.py /dev/shm/${minusvcf%.*} "A" "G" | sort | uniq > /dev/shm/KO1_techrep1_unlabeled.minus.readids

python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.plus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam --readids /dev/shm/KO1_techrep1_unlabeled.plus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam
python /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/workflow/4SUseq/workflow/scripts/filter_bam_by_readids.py -i /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/hisat2/KO1_techrep1_unlabeled.minus.bam -o /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam --readids /dev/shm/KO1_techrep1_unlabeled.minus.readids -o2 /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.mutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam /dev/shm/KO1_techrep1_unlabeled.mutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.mutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat

samtools merge -c -f -p -@ 4 /dev/shm/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.plus.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.minus.bam
sambamba sort --memory-limit=200G --tmpdir=/dev/shm --nthreads=4 --out=/data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam /dev/shm/KO1_techrep1_unlabeled.unmutated.bam && rm -f /dev/shm/KO1_techrep1_unlabeled.unmutated.bam
sambamba flagstat --nthreads=4 /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam > /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat

        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: 19813301

Error executing rule split_bam_by_mutation on cluster (jobid: 94, external: 19813301, jobscript: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/tmp.0y0go555/snakejob.split_bam_by_mutation.94.sh). For error details see the cluster log and the log files of the involved rule(s).
Job failed, going on with independent jobs.
Exiting because a job execution failed. Look above for error message
Complete log: /gpfs/gsfs11/users/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/.snakemake/log/2021-07-22T222304.423466.snakemake.log
Building DAG of jobs...
Creating report...
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_4SU_labeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_unlabeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_4SU_labeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO8_unlabeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_4SU_labeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT3_unlabeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_4SU_labeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_unlabeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_1.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_labeled_2.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_1.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/SRA_unlabeled_2.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep1_unlabeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/KO1_techrep2_unlabeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep1_unlabeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.mutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/bams/WT4_techrep2_unlabeled.unmutated.bam.flagstat. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/nfragments.tsv. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_4SU_labeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_4SU_labeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_4SU_labeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_4SU_labeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_unlabeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_unlabeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_unlabeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_unlabeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO8_4SU_labeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO8_4SU_labeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO8_4SU_labeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO8_4SU_labeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO8_unlabeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO8_unlabeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO8_unlabeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO8_unlabeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT3_4SU_labeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT3_4SU_labeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT3_4SU_labeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT3_4SU_labeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT3_unlabeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT3_unlabeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT3_unlabeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT3_unlabeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_4SU_labeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_4SU_labeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_4SU_labeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_4SU_labeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_unlabeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_unlabeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_unlabeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_unlabeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_labeled_1.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_labeled_1.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_labeled_1.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_labeled_1.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_labeled_2.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_labeled_2.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_labeled_2.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_labeled_2.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_unlabeled_1.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_unlabeled_1.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_unlabeled_1.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_unlabeled_1.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_unlabeled_2.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_unlabeled_2.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_unlabeled_2.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/SRA_unlabeled_2.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_techrep1_unlabeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_techrep1_unlabeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_techrep1_unlabeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_techrep1_unlabeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_techrep2_unlabeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_techrep2_unlabeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_techrep2_unlabeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/KO1_techrep2_unlabeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_techrep1_unlabeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_techrep1_unlabeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_techrep1_unlabeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_techrep1_unlabeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_techrep2_unlabeled.mutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_techrep2_unlabeled.mutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_techrep2_unlabeled.unmutated.exon.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/htseq/WT4_techrep2_unlabeled.unmutated.gene.counts. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_4SU_labeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_4SU_labeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_4SU_labeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_4SU_labeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_unlabeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_unlabeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_unlabeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_unlabeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO8_4SU_labeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO8_4SU_labeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO8_4SU_labeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO8_4SU_labeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO8_unlabeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO8_unlabeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO8_unlabeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO8_unlabeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT3_4SU_labeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT3_4SU_labeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT3_4SU_labeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT3_4SU_labeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT3_unlabeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT3_unlabeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT3_unlabeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT3_unlabeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_4SU_labeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_4SU_labeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_4SU_labeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_4SU_labeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_unlabeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_unlabeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_unlabeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_unlabeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_labeled_1.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_labeled_1.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_labeled_1.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_labeled_1.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_labeled_2.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_labeled_2.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_labeled_2.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_labeled_2.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_unlabeled_1.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_unlabeled_1.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_unlabeled_1.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_unlabeled_1.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_unlabeled_2.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_unlabeled_2.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_unlabeled_2.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/SRA_unlabeled_2.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_techrep1_unlabeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_techrep1_unlabeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_techrep1_unlabeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_techrep1_unlabeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_techrep2_unlabeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_techrep2_unlabeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_techrep2_unlabeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/KO1_techrep2_unlabeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_techrep1_unlabeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_techrep1_unlabeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_techrep1_unlabeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_techrep1_unlabeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_techrep2_unlabeled.mutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_techrep2_unlabeled.mutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_techrep2_unlabeled.unmutated.R1.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/filtered_reads/WT4_techrep2_unlabeled.unmutated.R2.fastq.gz. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/KO1_4SU_labeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/KO1_unlabeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/KO8_4SU_labeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/KO8_unlabeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/WT3_4SU_labeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/WT3_unlabeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/WT4_4SU_labeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/WT4_unlabeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/SRA_labeled_1.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/SRA_labeled_2.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/SRA_unlabeled_1.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/SRA_unlabeled_2.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/KO1_techrep1_unlabeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/KO1_techrep2_unlabeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/WT4_techrep1_unlabeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Missing metadata for file /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/qc/nfragments/WT4_techrep2_unlabeled.json. Maybe metadata was deleted or it was created using an older version of Snakemake. This is a non critical warning.
Downloading resources and rendering HTML.
Report created: /data/RBL_NCI/Wolin/mESC_slam_analysis/find_mutations_072221/find_mutations.runslurm_snakemake_report.html.
